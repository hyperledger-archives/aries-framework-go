// +build amd64,!generic

#include "textflag.h"
#include "funcdata.h"

// assigned addition with modular reduction
// a = (a + b) % p
TEXT ·fp2AddAssign(SB), NOSPLIT, $0-16
  MOVQ a+0(FP), DI
	MOVQ b+8(FP), SI

	MOVQ (DI), R8
	MOVQ 8(DI), R9
	MOVQ 16(DI), R10
	MOVQ 24(DI), R11
	MOVQ 32(DI), R12
	MOVQ 40(DI), R13

	ADDQ (SI), R8
	ADCQ 8(SI), R9
	ADCQ 16(SI), R10
	ADCQ 24(SI), R11
	ADCQ 32(SI), R12
	ADCQ 40(SI), R13

	MOVQ R8, R14
	MOVQ R9, R15
	MOVQ R10, CX
	MOVQ R11, DX
	MOVQ R12, BP
	MOVQ R13, BX

	MOVQ $0xb9feffffffffaaab, AX
	SUBQ AX, R14
	MOVQ $0x1eabfffeb153ffff, AX
	SBBQ AX, R15
	MOVQ $0x6730d2a0f6b0f624, AX
	SBBQ AX, CX
	MOVQ $0x64774b84f38512bf, AX
	SBBQ AX, DX
	MOVQ $0x4b1ba7b6434bacd7, AX
	SBBQ AX, BP
	MOVQ $0x1a0111ea397fe69a, AX
	SBBQ AX, BX

	CMOVQCC R14, R8
	CMOVQCC R15, R9
	CMOVQCC CX, R10
	CMOVQCC DX, R11
	CMOVQCC BP, R12
	CMOVQCC BX, R13

	MOVQ R8, (DI)
	MOVQ R9, 8(DI)
	MOVQ R10, 16(DI)
	MOVQ R11, 24(DI)
	MOVQ R12, 32(DI)
	MOVQ R13, 40(DI)

	MOVQ 48(DI), R8
	MOVQ 56(DI), R9
	MOVQ 64(DI), R10
	MOVQ 72(DI), R11
	MOVQ 80(DI), R12
	MOVQ 88(DI), R13

	ADDQ 48(SI), R8
	ADCQ 56(SI), R9
	ADCQ 64(SI), R10
	ADCQ 72(SI), R11
	ADCQ 80(SI), R12
	ADCQ 88(SI), R13

	MOVQ R8, R14
	MOVQ R9, R15
	MOVQ R10, CX
	MOVQ R11, DX
	MOVQ R12, SI
	MOVQ R13, BX

	MOVQ $0xb9feffffffffaaab, AX
	SUBQ AX, R14
	MOVQ $0x1eabfffeb153ffff, AX
	SBBQ AX, R15
	MOVQ $0x6730d2a0f6b0f624, AX
	SBBQ AX, CX
	MOVQ $0x64774b84f38512bf, AX
	SBBQ AX, DX
	MOVQ $0x4b1ba7b6434bacd7, AX
	SBBQ AX, SI
	MOVQ $0x1a0111ea397fe69a, AX
	SBBQ AX, BX

	CMOVQCC R14, R8
	CMOVQCC R15, R9
	CMOVQCC CX, R10
	CMOVQCC DX, R11
	CMOVQCC SI, R12
	CMOVQCC BX, R13

	MOVQ R8, 48(DI)
	MOVQ R9, 56(DI)
	MOVQ R10, 64(DI)
	MOVQ R11, 72(DI)
	MOVQ R12, 80(DI)
	MOVQ R13, 88(DI)

  RET
/*	 | end													*/


// addition with modular reduction
// c = (a + b) % p
TEXT ·fp2Add(SB), NOSPLIT, $0-24
  MOVQ a+8(FP), DI
	MOVQ b+16(FP), SI
	MOVQ c+0(FP), BP

	MOVQ (DI), R8
	MOVQ 8(DI), R9
	MOVQ 16(DI), R10
	MOVQ 24(DI), R11
	MOVQ 32(DI), R12
	MOVQ 40(DI), R13

	ADDQ (SI), R8
	ADCQ 8(SI), R9
	ADCQ 16(SI), R10
	ADCQ 24(SI), R11
	ADCQ 32(SI), R12
	ADCQ 40(SI), R13

	MOVQ R8, R14
	MOVQ R9, R15
	MOVQ R10, CX
	MOVQ R11, DX
	MOVQ R12, SI
	MOVQ R13, BX

	MOVQ $0xb9feffffffffaaab, AX
	SUBQ AX, R14
	MOVQ $0x1eabfffeb153ffff, AX
	SBBQ AX, R15
	MOVQ $0x6730d2a0f6b0f624, AX
	SBBQ AX, CX
	MOVQ $0x64774b84f38512bf, AX
	SBBQ AX, DX
	MOVQ $0x4b1ba7b6434bacd7, AX
	SBBQ AX, SI
	MOVQ $0x1a0111ea397fe69a, AX
	SBBQ AX, BX

	CMOVQCC R14, R8
	CMOVQCC R15, R9
	CMOVQCC CX, R10
	CMOVQCC DX, R11
	CMOVQCC SI, R12
	CMOVQCC BX, R13

	MOVQ R8, (BP)
	MOVQ R9, 8(BP)
	MOVQ R10, 16(BP)
	MOVQ R11, 24(BP)
	MOVQ R12, 32(BP)
	MOVQ R13, 40(BP)

	MOVQ b+16(FP), SI

	MOVQ 48(DI), R8
	MOVQ 56(DI), R9
	MOVQ 64(DI), R10
	MOVQ 72(DI), R11
	MOVQ 80(DI), R12
	MOVQ 88(DI), R13

	ADDQ 48(SI), R8
	ADCQ 56(SI), R9
	ADCQ 64(SI), R10
	ADCQ 72(SI), R11
	ADCQ 80(SI), R12
	ADCQ 88(SI), R13

	MOVQ R8, R14
	MOVQ R9, R15
	MOVQ R10, CX
	MOVQ R11, DX
	MOVQ R12, SI
	MOVQ R13, BX

	MOVQ $0xb9feffffffffaaab, AX
	SUBQ AX, R14
	MOVQ $0x1eabfffeb153ffff, AX
	SBBQ AX, R15
	MOVQ $0x6730d2a0f6b0f624, AX
	SBBQ AX, CX
	MOVQ $0x64774b84f38512bf, AX
	SBBQ AX, DX
	MOVQ $0x4b1ba7b6434bacd7, AX
	SBBQ AX, SI
	MOVQ $0x1a0111ea397fe69a, AX
	SBBQ AX, BX

	CMOVQCC R14, R8
	CMOVQCC R15, R9
	CMOVQCC CX, R10
	CMOVQCC DX, R11
	CMOVQCC SI, R12
	CMOVQCC BX, R13

	MOVQ R8, 48(BP)
	MOVQ R9, 56(BP)
	MOVQ R10, 64(BP)
	MOVQ R11, 72(BP)
	MOVQ R12, 80(BP)
	MOVQ R13, 88(BP)

  RET
/*	 | end													*/


// addition without reduction check
// c = (a + b)
TEXT ·fp2Ladd(SB), NOSPLIT, $0-24
	MOVQ a+8(FP), DI
	MOVQ b+16(FP), SI
	MOVQ c+0(FP), AX

	MOVQ (DI), R8
	MOVQ 8(DI), R9
	MOVQ 16(DI), R10
	MOVQ 24(DI), R11
	MOVQ 32(DI), R12
	MOVQ 40(DI), R13

	ADDQ (SI), R8
	ADCQ 8(SI), R9
	ADCQ 16(SI), R10
	ADCQ 24(SI), R11
	ADCQ 32(SI), R12
	ADCQ 40(SI), R13

	MOVQ R8, (AX)
	MOVQ R9, 8(AX)
	MOVQ R10, 16(AX)
	MOVQ R11, 24(AX)
	MOVQ R12, 32(AX)
	MOVQ R13, 40(AX)

	MOVQ 48(DI), R8
	MOVQ 56(DI), R9
	MOVQ 64(DI), R10
	MOVQ 72(DI), R11
	MOVQ 80(DI), R12
	MOVQ 88(DI), R13

	ADDQ 48(SI), R8
	ADCQ 56(SI), R9
	ADCQ 64(SI), R10
	ADCQ 72(SI), R11
	ADCQ 80(SI), R12
	ADCQ 88(SI), R13

	MOVQ R8, 48(AX)
	MOVQ R9, 56(AX)
	MOVQ R10, 64(AX)
	MOVQ R11, 72(AX)
	MOVQ R12, 80(AX)
	MOVQ R13, 88(AX)

	RET
/*	 | end													*/


// addition without reduction check
// c = (a + b)
TEXT ·fp2LaddAssign(SB), NOSPLIT, $0-16
	MOVQ a+0(FP), DI
	MOVQ b+8(FP), SI

	MOVQ (DI), R8
	MOVQ 8(DI), R9
	MOVQ 16(DI), R10
	MOVQ 24(DI), R11
	MOVQ 32(DI), R12
	MOVQ 40(DI), R13

	ADDQ (SI), R8
	ADCQ 8(SI), R9
	ADCQ 16(SI), R10
	ADCQ 24(SI), R11
	ADCQ 32(SI), R12
	ADCQ 40(SI), R13

	MOVQ R8, (DI)
	MOVQ R9, 8(DI)
	MOVQ R10, 16(DI)
	MOVQ R11, 24(DI)
	MOVQ R12, 32(DI)
	MOVQ R13, 40(DI)

	MOVQ 48(DI), R8
	MOVQ 56(DI), R9
	MOVQ 64(DI), R10
	MOVQ 72(DI), R11
	MOVQ 80(DI), R12
	MOVQ 88(DI), R13

	ADDQ 48(SI), R8
	ADCQ 56(SI), R9
	ADCQ 64(SI), R10
	ADCQ 72(SI), R11
	ADCQ 80(SI), R12
	ADCQ 88(SI), R13

	MOVQ R8, 48(DI)
	MOVQ R9, 56(DI)
	MOVQ R10, 64(DI)
	MOVQ R11, 72(DI)
	MOVQ R12, 80(DI)
	MOVQ R13, 88(DI)

	RET
/*	 | end													*/


// subtraction with modular reduction
// c = (a - b) % p
TEXT ·fp2Sub(SB), NOSPLIT, $0-24
	MOVQ a+8(FP), DI
	MOVQ b+16(FP), SI
	XORQ AX, AX

	MOVQ (DI), R8
	MOVQ 8(DI), R9
	MOVQ 16(DI), R10
	MOVQ 24(DI), R11
	MOVQ 32(DI), R12
	MOVQ 40(DI), R13

	SUBQ (SI), R8
	SBBQ 8(SI), R9
	SBBQ 16(SI), R10
	SBBQ 24(SI), R11
	SBBQ 32(SI), R12
	SBBQ 40(SI), R13

	MOVQ $0xb9feffffffffaaab, R14
	MOVQ $0x1eabfffeb153ffff, R15
	MOVQ $0x6730d2a0f6b0f624, CX
	MOVQ $0x64774b84f38512bf, DX
	MOVQ $0x4b1ba7b6434bacd7, BP
	MOVQ $0x1a0111ea397fe69a, BX

	CMOVQCC AX, R14
	CMOVQCC AX, R15
	CMOVQCC AX, CX
	CMOVQCC AX, DX
	CMOVQCC AX, BP
	CMOVQCC AX, BX

	ADDQ R14, R8
	ADCQ R15, R9
	ADCQ CX, R10
	ADCQ DX, R11
	ADCQ BP, R12
	ADCQ BX, R13

	MOVQ c+0(FP), BP
	MOVQ R8, (BP)
	MOVQ R9, 8(BP)
	MOVQ R10, 16(BP)
	MOVQ R11, 24(BP)
	MOVQ R12, 32(BP)
	MOVQ R13, 40(BP)

	MOVQ 48(DI), R8
	MOVQ 56(DI), R9
	MOVQ 64(DI), R10
	MOVQ 72(DI), R11
	MOVQ 80(DI), R12
	MOVQ 88(DI), R13

	SUBQ 48(SI), R8
	SBBQ 56(SI), R9
	SBBQ 64(SI), R10
	SBBQ 72(SI), R11
	SBBQ 80(SI), R12
	SBBQ 88(SI), R13

	MOVQ $0xb9feffffffffaaab, R14
	MOVQ $0x1eabfffeb153ffff, R15
	MOVQ $0x6730d2a0f6b0f624, CX
	MOVQ $0x64774b84f38512bf, DX
	MOVQ $0x4b1ba7b6434bacd7, BP
	MOVQ $0x1a0111ea397fe69a, BX

	CMOVQCC AX, R14
	CMOVQCC AX, R15
	CMOVQCC AX, CX
	CMOVQCC AX, DX
	CMOVQCC AX, BP
	CMOVQCC AX, BX

	ADDQ R14, R8
	ADCQ R15, R9
	ADCQ CX, R10
	ADCQ DX, R11
	ADCQ BP, R12
	ADCQ BX, R13

	MOVQ c+0(FP), BP
	MOVQ R8, 48(BP)
	MOVQ R9, 56(BP)
	MOVQ R10, 64(BP)
	MOVQ R11, 72(BP)
	MOVQ R12, 80(BP)
	MOVQ R13, 88(BP)

	RET
/*	 | end													*/


// assigned subtraction with modular reduction
// c = (a - b) % p
TEXT ·fp2SubAssign(SB), NOSPLIT, $0-16
	MOVQ a+0(FP), DI
	MOVQ b+8(FP), SI
	XORQ AX, AX

	MOVQ (DI), R8
	MOVQ 8(DI), R9
	MOVQ 16(DI), R10
	MOVQ 24(DI), R11
	MOVQ 32(DI), R12
	MOVQ 40(DI), R13

	SUBQ (SI), R8
	SBBQ 8(SI), R9
	SBBQ 16(SI), R10
	SBBQ 24(SI), R11
	SBBQ 32(SI), R12
	SBBQ 40(SI), R13

	MOVQ $0xb9feffffffffaaab, R14
	MOVQ $0x1eabfffeb153ffff, R15
	MOVQ $0x6730d2a0f6b0f624, CX
	MOVQ $0x64774b84f38512bf, DX
	MOVQ $0x4b1ba7b6434bacd7, BP
	MOVQ $0x1a0111ea397fe69a, BX

	CMOVQCC AX, R14
	CMOVQCC AX, R15
	CMOVQCC AX, CX
	CMOVQCC AX, DX
	CMOVQCC AX, BP
	CMOVQCC AX, BX

	ADDQ R14, R8
	ADCQ R15, R9
	ADCQ CX, R10
	ADCQ DX, R11
	ADCQ BP, R12
	ADCQ BX, R13

	MOVQ R8, (DI)
	MOVQ R9, 8(DI)
	MOVQ R10, 16(DI)
	MOVQ R11, 24(DI)
	MOVQ R12, 32(DI)
	MOVQ R13, 40(DI)

	MOVQ 48(DI), R8
	MOVQ 56(DI), R9
	MOVQ 64(DI), R10
	MOVQ 72(DI), R11
	MOVQ 80(DI), R12
	MOVQ 88(DI), R13

	SUBQ 48(SI), R8
	SBBQ 56(SI), R9
	SBBQ 64(SI), R10
	SBBQ 72(SI), R11
	SBBQ 80(SI), R12
	SBBQ 88(SI), R13

	MOVQ $0xb9feffffffffaaab, R14
	MOVQ $0x1eabfffeb153ffff, R15
	MOVQ $0x6730d2a0f6b0f624, CX
	MOVQ $0x64774b84f38512bf, DX
	MOVQ $0x4b1ba7b6434bacd7, BP
	MOVQ $0x1a0111ea397fe69a, BX

	CMOVQCC AX, R14
	CMOVQCC AX, R15
	CMOVQCC AX, CX
	CMOVQCC AX, DX
	CMOVQCC AX, BP
	CMOVQCC AX, BX

	ADDQ R14, R8
	ADCQ R15, R9
	ADCQ CX, R10
	ADCQ DX, R11
	ADCQ BP, R12
	ADCQ BX, R13

	MOVQ R8, 48(DI)
	MOVQ R9, 56(DI)
	MOVQ R10, 64(DI)
	MOVQ R11, 72(DI)
	MOVQ R12, 80(DI)
	MOVQ R13, 88(DI)

	RET
/*	 | end													*/


// assigned doubling with modular reduction
// a = (a + a) % p
TEXT ·fp2DoubleAssign(SB), NOSPLIT, $0-8
  MOVQ a+0(FP), DI

	MOVQ (DI), R8
	MOVQ 8(DI), R9
	MOVQ 16(DI), R10
	MOVQ 24(DI), R11
	MOVQ 32(DI), R12
	MOVQ 40(DI), R13

	ADDQ R8, R8
	ADCQ R9, R9
	ADCQ R10, R10
	ADCQ R11, R11
	ADCQ R12, R12
	ADCQ R13, R13

	MOVQ R8, R14
	MOVQ R9, R15
	MOVQ R10, CX
	MOVQ R11, DX
	MOVQ R12, SI
	MOVQ R13, BX

	MOVQ $0xb9feffffffffaaab, AX
	SUBQ AX, R14
	MOVQ $0x1eabfffeb153ffff, AX
	SBBQ AX, R15
	MOVQ $0x6730d2a0f6b0f624, AX
	SBBQ AX, CX
	MOVQ $0x64774b84f38512bf, AX
	SBBQ AX, DX
	MOVQ $0x4b1ba7b6434bacd7, AX
	SBBQ AX, SI
	MOVQ $0x1a0111ea397fe69a, AX
	SBBQ AX, BX

	CMOVQCC R14, R8
	CMOVQCC R15, R9
	CMOVQCC CX, R10
	CMOVQCC DX, R11
	CMOVQCC SI, R12
	CMOVQCC BX, R13

	MOVQ R8, (DI)
	MOVQ R9, 8(DI)
	MOVQ R10, 16(DI)
	MOVQ R11, 24(DI)
	MOVQ R12, 32(DI)
	MOVQ R13, 40(DI)

	MOVQ 48(DI), R8
	MOVQ 56(DI), R9
	MOVQ 64(DI), R10
	MOVQ 72(DI), R11
	MOVQ 80(DI), R12
	MOVQ 88(DI), R13

	ADDQ R8, R8
	ADCQ R9, R9
	ADCQ R10, R10
	ADCQ R11, R11
	ADCQ R12, R12
	ADCQ R13, R13

	MOVQ R8, R14
	MOVQ R9, R15
	MOVQ R10, CX
	MOVQ R11, DX
	MOVQ R12, SI
	MOVQ R13, BX

	MOVQ $0xb9feffffffffaaab, AX
	SUBQ AX, R14
	MOVQ $0x1eabfffeb153ffff, AX
	SBBQ AX, R15
	MOVQ $0x6730d2a0f6b0f624, AX
	SBBQ AX, CX
	MOVQ $0x64774b84f38512bf, AX
	SBBQ AX, DX
	MOVQ $0x4b1ba7b6434bacd7, AX
	SBBQ AX, SI
	MOVQ $0x1a0111ea397fe69a, AX
	SBBQ AX, BX

	CMOVQCC R14, R8
	CMOVQCC R15, R9
	CMOVQCC CX, R10
	CMOVQCC DX, R11
	CMOVQCC SI, R12
	CMOVQCC BX, R13

	MOVQ R8, 48(DI)
	MOVQ R9, 56(DI)
	MOVQ R10, 64(DI)
	MOVQ R11, 72(DI)
	MOVQ R12, 80(DI)
	MOVQ R13, 88(DI)

  RET
/*	 | end													*/


// doubling with modular reduction
// c = (a + a) % p
TEXT ·fp2Double(SB), NOSPLIT, $0-16
  MOVQ a+8(FP), DI
  MOVQ c+0(FP), SI

	MOVQ (DI), R8
	MOVQ 8(DI), R9
	MOVQ 16(DI), R10
	MOVQ 24(DI), R11
	MOVQ 32(DI), R12
	MOVQ 40(DI), R13

	ADDQ R8, R8
	ADCQ R9, R9
	ADCQ R10, R10
	ADCQ R11, R11
	ADCQ R12, R12
	ADCQ R13, R13

	MOVQ R8, R14
	MOVQ R9, R15
	MOVQ R10, CX
	MOVQ R11, DX
	MOVQ R12, BP
	MOVQ R13, BX

	MOVQ $0xb9feffffffffaaab, AX
	SUBQ AX, R14
	MOVQ $0x1eabfffeb153ffff, AX
	SBBQ AX, R15
	MOVQ $0x6730d2a0f6b0f624, AX
	SBBQ AX, CX
	MOVQ $0x64774b84f38512bf, AX
	SBBQ AX, DX
	MOVQ $0x4b1ba7b6434bacd7, AX
	SBBQ AX, BP
	MOVQ $0x1a0111ea397fe69a, AX
	SBBQ AX, BX

	CMOVQCC R14, R8
	CMOVQCC R15, R9
	CMOVQCC CX, R10
	CMOVQCC DX, R11
	CMOVQCC BP, R12
	CMOVQCC BX, R13

	MOVQ R8, (SI)
	MOVQ R9, 8(SI)
	MOVQ R10, 16(SI)
	MOVQ R11, 24(SI)
	MOVQ R12, 32(SI)
	MOVQ R13, 40(SI)

	MOVQ 48(DI), R8
	MOVQ 56(DI), R9
	MOVQ 64(DI), R10
	MOVQ 72(DI), R11
	MOVQ 80(DI), R12
	MOVQ 88(DI), R13

	ADDQ R8, R8
	ADCQ R9, R9
	ADCQ R10, R10
	ADCQ R11, R11
	ADCQ R12, R12
	ADCQ R13, R13

	MOVQ R8, R14
	MOVQ R9, R15
	MOVQ R10, CX
	MOVQ R11, DX
	MOVQ R12, BP
	MOVQ R13, BX

	MOVQ $0xb9feffffffffaaab, AX
	SUBQ AX, R14
	MOVQ $0x1eabfffeb153ffff, AX
	SBBQ AX, R15
	MOVQ $0x6730d2a0f6b0f624, AX
	SBBQ AX, CX
	MOVQ $0x64774b84f38512bf, AX
	SBBQ AX, DX
	MOVQ $0x4b1ba7b6434bacd7, AX
	SBBQ AX, BP
	MOVQ $0x1a0111ea397fe69a, AX
	SBBQ AX, BX

	CMOVQCC R14, R8
	CMOVQCC R15, R9
	CMOVQCC CX, R10
	CMOVQCC DX, R11
	CMOVQCC BP, R12
	CMOVQCC BX, R13

	MOVQ R8, 48(SI)
	MOVQ R9, 56(SI)
	MOVQ R10, 64(SI)
	MOVQ R11, 72(SI)
	MOVQ R12, 80(SI)
	MOVQ R13, 88(SI)

  RET
/*	 | end													*/


// a0 = a0 - a1
// a1 = a0 + a1
TEXT ·mulByNonResidueAssign(SB), NOSPLIT, $0-8
  MOVQ a+0(FP), DI
	XORQ AX, AX

	// a0
	MOVQ (DI), R8
	MOVQ 8(DI), R9
	MOVQ 16(DI), R10
	MOVQ 24(DI), R11
	MOVQ 32(DI), R12
	MOVQ 40(DI), R13

	// a0 - a1
	SUBQ 48(DI), R8
	SBBQ 56(DI), R9
	SBBQ 64(DI), R10
	SBBQ 72(DI), R11
	SBBQ 80(DI), R12
	SBBQ 88(DI), R13

	MOVQ $0xb9feffffffffaaab, R14
	MOVQ $0x1eabfffeb153ffff, R15
	MOVQ $0x6730d2a0f6b0f624, CX
	MOVQ $0x64774b84f38512bf, DX
	MOVQ $0x4b1ba7b6434bacd7, BP
	MOVQ $0x1a0111ea397fe69a, BX

	CMOVQCC AX, R14
	CMOVQCC AX, R15
	CMOVQCC AX, CX
	CMOVQCC AX, DX
	CMOVQCC AX, BP
	CMOVQCC AX, BX

	ADDQ R14, R8
	ADCQ R15, R9
	ADCQ CX, R10
	ADCQ DX, R11
	ADCQ BP, R12
	ADCQ BX, R13

	// a0
	MOVQ (DI), R14
	MOVQ 8(DI), R15
	MOVQ 16(DI), CX
	MOVQ 24(DI), DX
	MOVQ 32(DI), BP
	MOVQ 40(DI), BX

	// a0 = a0 - a1 
	MOVQ R8, (DI)
	MOVQ R9, 8(DI)
	MOVQ R10, 16(DI)
	MOVQ R11, 24(DI)
	MOVQ R12, 32(DI)
	MOVQ R13, 40(DI)

	// a0 + a1
	ADDQ 48(DI), R14
	ADCQ 56(DI), R15
	ADCQ 64(DI), CX
	ADCQ 72(DI), DX
	ADCQ 80(DI), BP
	ADCQ 88(DI), BX

	MOVQ R14, R8
	MOVQ R15, R9
	MOVQ CX, R10
	MOVQ DX, R11
	MOVQ BP, R12
	MOVQ BX, R13

	MOVQ $0xb9feffffffffaaab, AX
	SUBQ AX, R8
	MOVQ $0x1eabfffeb153ffff, AX
	SBBQ AX, R9
	MOVQ $0x6730d2a0f6b0f624, AX
	SBBQ AX, R10
	MOVQ $0x64774b84f38512bf, AX
	SBBQ AX, R11
	MOVQ $0x4b1ba7b6434bacd7, AX
	SBBQ AX, R12
	MOVQ $0x1a0111ea397fe69a, AX
	SBBQ AX, R13

	CMOVQCC R8, R14
	CMOVQCC R9, R15
	CMOVQCC R10, CX
	CMOVQCC R11, DX
	CMOVQCC R12, BP
	CMOVQCC R13, BX

	MOVQ R14, 48(DI)
	MOVQ R15, 56(DI)
	MOVQ CX, 64(DI)
	MOVQ DX, 72(DI)
	MOVQ BP, 80(DI)
	MOVQ BX, 88(DI)
  RET


// c0 = a0 - a1
// c1 = a0 + a1
TEXT ·mulByNonResidue(SB), NOSPLIT, $0-16
  MOVQ c+0(FP), SI
  MOVQ a+8(FP), DI
	XORQ AX, AX

	// a0
	MOVQ (DI), R8
	MOVQ 8(DI), R9
	MOVQ 16(DI), R10
	MOVQ 24(DI), R11
	MOVQ 32(DI), R12
	MOVQ 40(DI), R13

	// a0 - a1
	SUBQ 48(DI), R8
	SBBQ 56(DI), R9
	SBBQ 64(DI), R10
	SBBQ 72(DI), R11
	SBBQ 80(DI), R12
	SBBQ 88(DI), R13

	MOVQ $0xb9feffffffffaaab, R14
	MOVQ $0x1eabfffeb153ffff, R15
	MOVQ $0x6730d2a0f6b0f624, CX
	MOVQ $0x64774b84f38512bf, DX
	MOVQ $0x4b1ba7b6434bacd7, BP
	MOVQ $0x1a0111ea397fe69a, BX

	CMOVQCC AX, R14
	CMOVQCC AX, R15
	CMOVQCC AX, CX
	CMOVQCC AX, DX
	CMOVQCC AX, BP
	CMOVQCC AX, BX

	ADDQ R14, R8
	ADCQ R15, R9
	ADCQ CX, R10
	ADCQ DX, R11
	ADCQ BP, R12
	ADCQ BX, R13

	MOVQ R8, (SI)
	MOVQ R9, 8(SI)
	MOVQ R10, 16(SI)
	MOVQ R11, 24(SI)
	MOVQ R12, 32(SI)
	MOVQ R13, 40(SI)

	// a0
	MOVQ (DI), R14
	MOVQ 8(DI), R15
	MOVQ 16(DI), CX
	MOVQ 24(DI), DX
	MOVQ 32(DI), BP
	MOVQ 40(DI), BX

	// a0 + a1
	ADDQ 48(DI), R14
	ADCQ 56(DI), R15
	ADCQ 64(DI), CX
	ADCQ 72(DI), DX
	ADCQ 80(DI), BP
	ADCQ 88(DI), BX

	MOVQ R14, R8
	MOVQ R15, R9
	MOVQ CX, R10
	MOVQ DX, R11
	MOVQ BP, R12
	MOVQ BX, R13

	MOVQ $0xb9feffffffffaaab, AX
	SUBQ AX, R8
	MOVQ $0x1eabfffeb153ffff, AX
	SBBQ AX, R9
	MOVQ $0x6730d2a0f6b0f624, AX
	SBBQ AX, R10
	MOVQ $0x64774b84f38512bf, AX
	SBBQ AX, R11
	MOVQ $0x4b1ba7b6434bacd7, AX
	SBBQ AX, R12
	MOVQ $0x1a0111ea397fe69a, AX
	SBBQ AX, R13


	CMOVQCC R8, R14
	CMOVQCC R9, R15
	CMOVQCC R10, CX
	CMOVQCC R11, DX
	CMOVQCC R12, BP
	CMOVQCC R13, BX

	MOVQ R14, 48(SI)
	MOVQ R15, 56(SI)
	MOVQ CX, 64(SI)
	MOVQ DX, 72(SI)
	MOVQ BP, 80(SI)
	MOVQ BX, 88(SI)
  RET


TEXT ·wfp2Add(SB), NOSPLIT, $0-24
 	MOVQ a+8(FP), DI		
 	MOVQ b+16(FP), SI
	MOVQ c+0(FP), DX

 	MOVQ (DI), R8		
 	MOVQ 8(DI), R9		
 	MOVQ 16(DI), R10		
 	MOVQ 24(DI), R11		
 	MOVQ 32(DI), R12		
 	MOVQ 40(DI), R13		
 	MOVQ 48(DI), R14		
 	MOVQ 56(DI), R15		
 	MOVQ 64(DI), AX		
 	MOVQ 72(DI), BX		
 	MOVQ 80(DI), CX		
 	MOVQ 88(DI), BP		

 	ADDQ (SI), R8		
 	ADCQ 8(SI), R9		
 	ADCQ 16(SI), R10		
 	ADCQ 24(SI), R11		
 	ADCQ 32(SI), R12		
 	ADCQ 40(SI), R13		
 	ADCQ 48(SI), R14		
 	ADCQ 56(SI), R15		
 	ADCQ 64(SI), AX		
 	ADCQ 72(SI), BX		
 	ADCQ 80(SI), CX		
 	ADCQ 88(SI), BP		

 	MOVQ R8, (DX)		
 	MOVQ R9, 8(DX)		
 	MOVQ R10, 16(DX)		
 	MOVQ R11, 24(DX)		
 	MOVQ R12, 32(DX)		
 	MOVQ R13, 40(DX)		
 
  MOVQ R14, R8		
 	MOVQ R15, R9		
 	MOVQ AX, R10		
 	MOVQ BX, R11		
 	MOVQ CX, R12		
 	MOVQ BP, R13		
 
	MOVQ $0xb9feffffffffaaab, DX
	SUBQ DX, R8
	MOVQ $0x1eabfffeb153ffff, DX
	SBBQ DX, R9
	MOVQ $0x6730d2a0f6b0f624, DX
	SBBQ DX, R10
	MOVQ $0x64774b84f38512bf, DX
	SBBQ DX, R11
	MOVQ $0x4b1ba7b6434bacd7, DX
	SBBQ DX, R12
	MOVQ $0x1a0111ea397fe69a, DX
	SBBQ DX, R13

 	CMOVQCC R8, R14		
 	CMOVQCC R9, R15		
 	CMOVQCC R10, AX		
 	CMOVQCC R11, BX		
 	CMOVQCC R12, CX		
 	CMOVQCC R13, BP

	MOVQ c+0(FP), DX

 	MOVQ R14, 48(DX)		
 	MOVQ R15, 56(DX)		
 	MOVQ AX, 64(DX)		
 	MOVQ BX, 72(DX)		
 	MOVQ CX, 80(DX)		
 	MOVQ BP, 88(DX)		

	MOVQ 96(DI), R8		
 	MOVQ 104(DI), R9		
 	MOVQ 112(DI), R10		
 	MOVQ 120(DI), R11		
 	MOVQ 128(DI), R12		
 	MOVQ 136(DI), R13		
 	MOVQ 144(DI), R14		
 	MOVQ 152(DI), R15		
 	MOVQ 160(DI), AX		
 	MOVQ 168(DI), BX		
 	MOVQ 176(DI), CX		
 	MOVQ 184(DI), BP		

 	ADDQ 96(SI), R8		
 	ADCQ 104(SI), R9		
 	ADCQ 112(SI), R10		
 	ADCQ 120(SI), R11		
 	ADCQ 128(SI), R12		
 	ADCQ 136(SI), R13		
 	ADCQ 144(SI), R14		
 	ADCQ 152(SI), R15		
 	ADCQ 160(SI), AX		
 	ADCQ 168(SI), BX		
 	ADCQ 176(SI), CX		
 	ADCQ 184(SI), BP		

 	MOVQ R8, 96(DX)		
 	MOVQ R9, 104(DX)		
 	MOVQ R10, 112(DX)		
 	MOVQ R11, 120(DX)		
 	MOVQ R12, 128(DX)		
 	MOVQ R13, 136(DX)		

  MOVQ R14, R8		
 	MOVQ R15, R9		
 	MOVQ AX, R10		
 	MOVQ BX, R11		
 	MOVQ CX, R12		
 	MOVQ BP, R13		
 	MOVQ $0xb9feffffffffaaab, DI
	SUBQ DI, R8
	MOVQ $0x1eabfffeb153ffff, DI
	SBBQ DI, R9
	MOVQ $0x6730d2a0f6b0f624, DI
	SBBQ DI, R10
	MOVQ $0x64774b84f38512bf, DI
	SBBQ DI, R11
	MOVQ $0x4b1ba7b6434bacd7, DI
	SBBQ DI, R12
	MOVQ $0x1a0111ea397fe69a, DI
	SBBQ DI, R13
 	CMOVQCC R8, R14		
 	CMOVQCC R9, R15		
 	CMOVQCC R10, AX		
 	CMOVQCC R11, BX		
 	CMOVQCC R12, CX		
 	CMOVQCC R13, BP		

 	MOVQ R14, 144(DX)		
 	MOVQ R15, 152(DX)		
 	MOVQ AX, 160(DX)		
 	MOVQ BX, 168(DX)		
 	MOVQ CX, 176(DX)		
 	MOVQ BP, 184(DX)
 	RET


TEXT ·wfp2AddAssign(SB), NOSPLIT, $0-16		
 	MOVQ a+0(FP), DI		
 	MOVQ b+8(FP), SI

 	MOVQ (DI), R8		
 	MOVQ 8(DI), R9		
 	MOVQ 16(DI), R10		
 	MOVQ 24(DI), R11		
 	MOVQ 32(DI), R12		
 	MOVQ 40(DI), R13		
 	MOVQ 48(DI), R14		
 	MOVQ 56(DI), R15		
 	MOVQ 64(DI), AX		
 	MOVQ 72(DI), BX		
 	MOVQ 80(DI), CX		
 	MOVQ 88(DI), DX		

 	ADDQ (SI), R8		
 	ADCQ 8(SI), R9		
 	ADCQ 16(SI), R10		
 	ADCQ 24(SI), R11		
 	ADCQ 32(SI), R12		
 	ADCQ 40(SI), R13		
 	ADCQ 48(SI), R14		
 	ADCQ 56(SI), R15		
 	ADCQ 64(SI), AX		
 	ADCQ 72(SI), BX		
 	ADCQ 80(SI), CX		
 	ADCQ 88(SI), DX		

 	MOVQ R8, (DI)		
 	MOVQ R9, 8(DI)		
 	MOVQ R10, 16(DI)		
 	MOVQ R11, 24(DI)		
 	MOVQ R12, 32(DI)		
 	MOVQ R13, 40(DI)		
 
  MOVQ R14, R8		
 	MOVQ R15, R9		
 	MOVQ AX, R10		
 	MOVQ BX, R11		
 	MOVQ CX, R12		
 	MOVQ DX, R13
	MOVQ $0xb9feffffffffaaab, BP
	SUBQ BP, R8
	MOVQ $0x1eabfffeb153ffff, BP
	SBBQ BP, R9
	MOVQ $0x6730d2a0f6b0f624, BP
	SBBQ BP, R10
	MOVQ $0x64774b84f38512bf, BP
	SBBQ BP, R11
	MOVQ $0x4b1ba7b6434bacd7, BP
	SBBQ BP, R12
	MOVQ $0x1a0111ea397fe69a, BP
	SBBQ BP, R13
 	CMOVQCC R8, R14		
 	CMOVQCC R9, R15		
 	CMOVQCC R10, AX		
 	CMOVQCC R11, BX		
 	CMOVQCC R12, CX		
 	CMOVQCC R13, DX		

 	MOVQ R14, 48(DI)
 	MOVQ R15, 56(DI)
 	MOVQ AX, 64(DI)
 	MOVQ BX, 72(DI)
 	MOVQ CX, 80(DI)
 	MOVQ DX, 88(DI)


	MOVQ 96(DI), R8		
 	MOVQ 104(DI), R9		
 	MOVQ 112(DI), R10		
 	MOVQ 120(DI), R11		
 	MOVQ 128(DI), R12		
 	MOVQ 136(DI), R13		
 	MOVQ 144(DI), R14		
 	MOVQ 152(DI), R15		
 	MOVQ 160(DI), AX		
 	MOVQ 168(DI), BX		
 	MOVQ 176(DI), CX		
 	MOVQ 184(DI), DX		

 	ADDQ 96(SI), R8		
 	ADCQ 104(SI), R9		
 	ADCQ 112(SI), R10		
 	ADCQ 120(SI), R11		
 	ADCQ 128(SI), R12		
 	ADCQ 136(SI), R13		
 	ADCQ 144(SI), R14		
 	ADCQ 152(SI), R15		
 	ADCQ 160(SI), AX		
 	ADCQ 168(SI), BX		
 	ADCQ 176(SI), CX		
 	ADCQ 184(SI), DX		

 	MOVQ R8, 96(DI)		
 	MOVQ R9, 104(DI)		
 	MOVQ R10, 112(DI)		
 	MOVQ R11, 120(DI)		
 	MOVQ R12, 128(DI)		
 	MOVQ R13, 136(DI)		

  MOVQ R14, R8		
 	MOVQ R15, R9		
 	MOVQ AX, R10		
 	MOVQ BX, R11		
 	MOVQ CX, R12		
 	MOVQ DX, R13		
 	MOVQ $0xb9feffffffffaaab, BP
	SUBQ BP, R8
	MOVQ $0x1eabfffeb153ffff, BP
	SBBQ BP, R9
	MOVQ $0x6730d2a0f6b0f624, BP
	SBBQ BP, R10
	MOVQ $0x64774b84f38512bf, BP
	SBBQ BP, R11
	MOVQ $0x4b1ba7b6434bacd7, BP
	SBBQ BP, R12
	MOVQ $0x1a0111ea397fe69a, BP
	SBBQ BP, R13
 	CMOVQCC R8, R14		
 	CMOVQCC R9, R15		
 	CMOVQCC R10, AX		
 	CMOVQCC R11, BX		
 	CMOVQCC R12, CX		
 	CMOVQCC R13, DX		

 	MOVQ R14, 144(DI)
 	MOVQ R15, 152(DI)
 	MOVQ AX, 160(DI)
 	MOVQ BX, 168(DI)
 	MOVQ CX, 176(DI)
 	MOVQ DX, 184(DI)
 	RET


TEXT ·wfp2AddMixed(SB), NOSPLIT, $0-24		
 	MOVQ a+8(FP), DI		
 	MOVQ b+16(FP), SI
	MOVQ c+0(FP), DX		

	MOVQ 96(DI), R8		
 	MOVQ 104(DI), R9		
 	MOVQ 112(DI), R10		
 	MOVQ 120(DI), R11		
 	MOVQ 128(DI), R12		
 	MOVQ 136(DI), R13		
 	MOVQ 144(DI), R14		
 	MOVQ 152(DI), R15		
 	MOVQ 160(DI), AX		
 	MOVQ 168(DI), BX		
 	MOVQ 176(DI), CX		
 	MOVQ 184(DI), BP		

 	ADDQ 96(SI), R8		
 	ADCQ 104(SI), R9		
 	ADCQ 112(SI), R10		
 	ADCQ 120(SI), R11		
 	ADCQ 128(SI), R12		
 	ADCQ 136(SI), R13		
 	ADCQ 144(SI), R14		
 	ADCQ 152(SI), R15		
 	ADCQ 160(SI), AX		
 	ADCQ 168(SI), BX		
 	ADCQ 176(SI), CX		
 	ADCQ 184(SI), BP		

 	MOVQ R8, 96(DX)		
 	MOVQ R9, 104(DX)		
 	MOVQ R10, 112(DX)		
 	MOVQ R11, 120(DX)		
 	MOVQ R12, 128(DX)		
 	MOVQ R13, 136(DX)
 	MOVQ R14, 144(DX)		
 	MOVQ R15, 152(DX)		
 	MOVQ AX, 160(DX)		
 	MOVQ BX, 168(DX)		
 	MOVQ CX, 176(DX)		
 	MOVQ BP, 184(DX)

 	MOVQ (DI), R8		
 	MOVQ 8(DI), R9		
 	MOVQ 16(DI), R10		
 	MOVQ 24(DI), R11		
 	MOVQ 32(DI), R12		
 	MOVQ 40(DI), R13		
 	MOVQ 48(DI), R14		
 	MOVQ 56(DI), R15		
 	MOVQ 64(DI), AX		
 	MOVQ 72(DI), BX		
 	MOVQ 80(DI), CX		
 	MOVQ 88(DI), BP		

 	ADDQ (SI), R8		
 	ADCQ 8(SI), R9		
 	ADCQ 16(SI), R10		
 	ADCQ 24(SI), R11		
 	ADCQ 32(SI), R12		
 	ADCQ 40(SI), R13		
 	ADCQ 48(SI), R14		
 	ADCQ 56(SI), R15		
 	ADCQ 64(SI), AX		
 	ADCQ 72(SI), BX		
 	ADCQ 80(SI), CX		
 	ADCQ 88(SI), BP		

 	MOVQ R8, (DX)		
 	MOVQ R9, 8(DX)		
 	MOVQ R10, 16(DX)		
 	MOVQ R11, 24(DX)		
 	MOVQ R12, 32(DX)		
 	MOVQ R13, 40(DX)		

 
  MOVQ R14, R8		
 	MOVQ R15, R9		
 	MOVQ AX, R10		
 	MOVQ BX, R11		
 	MOVQ CX, R12		
 	MOVQ BP, R13		
	MOVQ $0xb9feffffffffaaab, DI
	SUBQ DI, R8
	MOVQ $0x1eabfffeb153ffff, DI
	SBBQ DI, R9
	MOVQ $0x6730d2a0f6b0f624, DI
	SBBQ DI, R10
	MOVQ $0x64774b84f38512bf, DI
	SBBQ DI, R11
	MOVQ $0x4b1ba7b6434bacd7, DI
	SBBQ DI, R12
	MOVQ $0x1a0111ea397fe69a, DI
	SBBQ DI, R13
 	CMOVQCC R8, R14		
 	CMOVQCC R9, R15		
 	CMOVQCC R10, AX		
 	CMOVQCC R11, BX		
 	CMOVQCC R12, CX		
 	CMOVQCC R13, BP		

 	MOVQ R14, 48(DX)		
 	MOVQ R15, 56(DX)		
 	MOVQ AX, 64(DX)		
 	MOVQ BX, 72(DX)		
 	MOVQ CX, 80(DX)		
 	MOVQ BP, 88(DX)		
 	RET


TEXT ·wfp2AddMixedAssign(SB), NOSPLIT, $0-16

 	MOVQ a+0(FP), DI		
 	MOVQ b+8(FP), SI	

	MOVQ 96(DI), R8		
 	MOVQ 104(DI), R9		
 	MOVQ 112(DI), R10		
 	MOVQ 120(DI), R11		
 	MOVQ 128(DI), R12		
 	MOVQ 136(DI), R13		
 	MOVQ 144(DI), R14		
 	MOVQ 152(DI), R15		
 	MOVQ 160(DI), AX		
 	MOVQ 168(DI), BX		
 	MOVQ 176(DI), CX		
 	MOVQ 184(DI), BP		

 	ADDQ 96(SI), R8		
 	ADCQ 104(SI), R9		
 	ADCQ 112(SI), R10		
 	ADCQ 120(SI), R11		
 	ADCQ 128(SI), R12		
 	ADCQ 136(SI), R13		
 	ADCQ 144(SI), R14		
 	ADCQ 152(SI), R15		
 	ADCQ 160(SI), AX		
 	ADCQ 168(SI), BX		
 	ADCQ 176(SI), CX		
 	ADCQ 184(SI), BP		

 	MOVQ R8, 96(DI)		
 	MOVQ R9, 104(DI)		
 	MOVQ R10, 112(DI)		
 	MOVQ R11, 120(DI)		
 	MOVQ R12, 128(DI)		
 	MOVQ R13, 136(DI)
 	MOVQ R14, 144(DI)		
 	MOVQ R15, 152(DI)		
 	MOVQ AX, 160(DI)		
 	MOVQ BX, 168(DI)		
 	MOVQ CX, 176(DI)		
 	MOVQ BP, 184(DI)

 	MOVQ (DI), R8		
 	MOVQ 8(DI), R9		
 	MOVQ 16(DI), R10		
 	MOVQ 24(DI), R11		
 	MOVQ 32(DI), R12		
 	MOVQ 40(DI), R13		
 	MOVQ 48(DI), R14		
 	MOVQ 56(DI), R15		
 	MOVQ 64(DI), AX		
 	MOVQ 72(DI), BX		
 	MOVQ 80(DI), CX		
 	MOVQ 88(DI), BP		

 	ADDQ (SI), R8		
 	ADCQ 8(SI), R9		
 	ADCQ 16(SI), R10		
 	ADCQ 24(SI), R11		
 	ADCQ 32(SI), R12		
 	ADCQ 40(SI), R13		
 	ADCQ 48(SI), R14		
 	ADCQ 56(SI), R15		
 	ADCQ 64(SI), AX		
 	ADCQ 72(SI), BX		
 	ADCQ 80(SI), CX		
 	ADCQ 88(SI), BP		

 	MOVQ R8, (DI)		
 	MOVQ R9, 8(DI)		
 	MOVQ R10, 16(DI)		
 	MOVQ R11, 24(DI)		
 	MOVQ R12, 32(DI)		
 	MOVQ R13, 40(DI)		
 
  MOVQ R14, R8		
 	MOVQ R15, R9		
 	MOVQ AX, R10		
 	MOVQ BX, R11		
 	MOVQ CX, R12		
 	MOVQ BP, R13		
 	MOVQ $0xb9feffffffffaaab, SI
	SUBQ SI, R8
	MOVQ $0x1eabfffeb153ffff, SI
	SBBQ SI, R9
	MOVQ $0x6730d2a0f6b0f624, SI
	SBBQ SI, R10
	MOVQ $0x64774b84f38512bf, SI
	SBBQ SI, R11
	MOVQ $0x4b1ba7b6434bacd7, SI
	SBBQ SI, R12
	MOVQ $0x1a0111ea397fe69a, SI
	SBBQ SI, R13	
 	CMOVQCC R8, R14		
 	CMOVQCC R9, R15		
 	CMOVQCC R10, AX		
 	CMOVQCC R11, BX		
 	CMOVQCC R12, CX		
 	CMOVQCC R13, BP		

 	MOVQ R14, 48(DI)		
 	MOVQ R15, 56(DI)		
 	MOVQ AX, 64(DI)		
 	MOVQ BX, 72(DI)		
 	MOVQ CX, 80(DI)		
 	MOVQ BP, 88(DI)
 	RET


TEXT ·wfp2Ladd(SB), NOSPLIT, $0-24
 	MOVQ a+8(FP), DI		
 	MOVQ b+16(FP), SI		
 	MOVQ c+0(FP), DX
	
 	MOVQ (DI), R8		
 	MOVQ 8(DI), R9		
 	MOVQ 16(DI), R10		
 	MOVQ 24(DI), R11		
 	MOVQ 32(DI), R12		
 	MOVQ 40(DI), R13		
 	MOVQ 48(DI), R14		
 	MOVQ 56(DI), R15		
 	MOVQ 64(DI), AX		
 	MOVQ 72(DI), BX		
 	MOVQ 80(DI), CX		
 	MOVQ 88(DI), BP		

 	ADDQ (SI), R8		
 	ADCQ 8(SI), R9		
 	ADCQ 16(SI), R10		
 	ADCQ 24(SI), R11		
 	ADCQ 32(SI), R12		
 	ADCQ 40(SI), R13		
 	ADCQ 48(SI), R14		
 	ADCQ 56(SI), R15		
 	ADCQ 64(SI), AX		
 	ADCQ 72(SI), BX		
 	ADCQ 80(SI), CX		
 	ADCQ 88(SI), BP		
	
 	MOVQ R8, (DX)		
 	MOVQ R9, 8(DX)		
 	MOVQ R10, 16(DX)		
 	MOVQ R11, 24(DX)		
 	MOVQ R12, 32(DX)		
 	MOVQ R13, 40(DX)		
 	MOVQ R14, 48(DX)		
 	MOVQ R15, 56(DX)		
 	MOVQ AX, 64(DX)		
 	MOVQ BX, 72(DX)		
 	MOVQ CX, 80(DX)		
 	MOVQ BP, 88(DX)

	MOVQ 96(DI), R8		
 	MOVQ 104(DI), R9		
 	MOVQ 112(DI), R10		
 	MOVQ 120(DI), R11		
 	MOVQ 128(DI), R12		
 	MOVQ 136(DI), R13		
 	MOVQ 144(DI), R14		
 	MOVQ 152(DI), R15		
 	MOVQ 160(DI), AX		
 	MOVQ 168(DI), BX		
 	MOVQ 176(DI), CX		
 	MOVQ 184(DI), BP		

 	ADDQ 96(SI), R8		
 	ADCQ 104(SI), R9		
 	ADCQ 112(SI), R10		
 	ADCQ 120(SI), R11		
 	ADCQ 128(SI), R12		
 	ADCQ 136(SI), R13		
 	ADCQ 144(SI), R14		
 	ADCQ 152(SI), R15		
 	ADCQ 160(SI), AX		
 	ADCQ 168(SI), BX		
 	ADCQ 176(SI), CX		
 	ADCQ 184(SI), BP		
	
 	MOVQ R8, 96(DX)		
 	MOVQ R9, 104(DX)		
 	MOVQ R10, 112(DX)		
 	MOVQ R11, 120(DX)		
 	MOVQ R12, 128(DX)		
 	MOVQ R13, 136(DX)		
 	MOVQ R14, 144(DX)		
 	MOVQ R15, 152(DX)		
 	MOVQ AX, 160(DX)		
 	MOVQ BX, 168(DX)		
 	MOVQ CX, 176(DX)		
 	MOVQ BP, 184(DX)
 	RET


TEXT ·wfp2LaddAssign(SB), NOSPLIT, $0-16
 	MOVQ a+0(FP), DI		
 	MOVQ b+8(FP), SI		
	
 	MOVQ (DI), R8		
 	MOVQ 8(DI), R9		
 	MOVQ 16(DI), R10		
 	MOVQ 24(DI), R11		
 	MOVQ 32(DI), R12		
 	MOVQ 40(DI), R13		
 	MOVQ 48(DI), R14		
 	MOVQ 56(DI), R15		
 	MOVQ 64(DI), AX		
 	MOVQ 72(DI), BX		
 	MOVQ 80(DI), CX		
 	MOVQ 88(DI), BP		

 	ADDQ (SI), R8		
 	ADCQ 8(SI), R9		
 	ADCQ 16(SI), R10		
 	ADCQ 24(SI), R11		
 	ADCQ 32(SI), R12		
 	ADCQ 40(SI), R13		
 	ADCQ 48(SI), R14		
 	ADCQ 56(SI), R15		
 	ADCQ 64(SI), AX		
 	ADCQ 72(SI), BX		
 	ADCQ 80(SI), CX		
 	ADCQ 88(SI), BP		
	
 	MOVQ R8, (DI)		
 	MOVQ R9, 8(DI)		
 	MOVQ R10, 16(DI)		
 	MOVQ R11, 24(DI)		
 	MOVQ R12, 32(DI)		
 	MOVQ R13, 40(DI)		
 	MOVQ R14, 48(DI)		
 	MOVQ R15, 56(DI)		
 	MOVQ AX, 64(DI)		
 	MOVQ BX, 72(DI)		
 	MOVQ CX, 80(DI)		
 	MOVQ BP, 88(DI)

	MOVQ 96(DI), R8		
 	MOVQ 104(DI), R9		
 	MOVQ 112(DI), R10		
 	MOVQ 120(DI), R11		
 	MOVQ 128(DI), R12		
 	MOVQ 136(DI), R13		
 	MOVQ 144(DI), R14		
 	MOVQ 152(DI), R15		
 	MOVQ 160(DI), AX		
 	MOVQ 168(DI), BX		
 	MOVQ 176(DI), CX		
 	MOVQ 184(DI), BP		

 	ADDQ 96(SI), R8		
 	ADCQ 104(SI), R9		
 	ADCQ 112(SI), R10		
 	ADCQ 120(SI), R11		
 	ADCQ 128(SI), R12		
 	ADCQ 136(SI), R13		
 	ADCQ 144(SI), R14		
 	ADCQ 152(SI), R15		
 	ADCQ 160(SI), AX		
 	ADCQ 168(SI), BX		
 	ADCQ 176(SI), CX		
 	ADCQ 184(SI), BP		
	
 	MOVQ R8, 96(DI)		
 	MOVQ R9, 104(DI)		
 	MOVQ R10, 112(DI)		
 	MOVQ R11, 120(DI)		
 	MOVQ R12, 128(DI)		
 	MOVQ R13, 136(DI)		
 	MOVQ R14, 144(DI)		
 	MOVQ R15, 152(DI)		
 	MOVQ AX, 160(DI)		
 	MOVQ BX, 168(DI)		
 	MOVQ CX, 176(DI)		
 	MOVQ BP, 184(DI)
 	RET


TEXT ·wfp2Sub(SB), NOSPLIT, $0-24		
 	MOVQ a+8(FP), DI		
 	MOVQ b+16(FP), SI
 	MOVQ c+0(FP), BP		
	
 	MOVQ (DI), R8		
 	MOVQ 8(DI), R9		
 	MOVQ 16(DI), R10		
 	MOVQ 24(DI), R11		
 	MOVQ 32(DI), R12		
 	MOVQ 40(DI), R13		
 	MOVQ 48(DI), R14		
 	MOVQ 56(DI), R15		
 	MOVQ 64(DI), AX		
 	MOVQ 72(DI), BX		
 	MOVQ 80(DI), CX		
 	MOVQ 88(DI), DX		

 	SUBQ (SI), R8		
 	SBBQ 8(SI), R9		
 	SBBQ 16(SI), R10		
 	SBBQ 24(SI), R11		
 	SBBQ 32(SI), R12		
 	SBBQ 40(SI), R13		
 	SBBQ 48(SI), R14		
 	SBBQ 56(SI), R15		
 	SBBQ 64(SI), AX		
 	SBBQ 72(SI), BX		
 	SBBQ 80(SI), CX		
 	SBBQ 88(SI), DX		

 	MOVQ R8, (BP)		
 	MOVQ R9, 8(BP)		
 	MOVQ R10, 16(BP)		
 	MOVQ R11, 24(BP)		
 	MOVQ R12, 32(BP)		
 	MOVQ R13, 40(BP)		

  MOVQ $0, SI
 	MOVQ $0xb9feffffffffaaab, R8		
 	MOVQ $0x1eabfffeb153ffff, R9		
 	MOVQ $0x6730d2a0f6b0f624, R10		
 	MOVQ $0x64774b84f38512bf, R11		
 	MOVQ $0x4b1ba7b6434bacd7, R12		
 	MOVQ $0x1a0111ea397fe69a, R13		
 	CMOVQCC SI, R8		
 	CMOVQCC SI, R9		
 	CMOVQCC SI, R10		
 	CMOVQCC SI, R11		
 	CMOVQCC SI, R12		
 	CMOVQCC SI, R13		
 	ADDQ R8, R14		
 	ADCQ R9, R15		
 	ADCQ R10, AX		
 	ADCQ R11, BX		
 	ADCQ R12, CX		
 	ADCQ R13, DX		
	
 	MOVQ R14, 48(BP)		
 	MOVQ R15, 56(BP)		
 	MOVQ AX, 64(BP)		
 	MOVQ BX, 72(BP)		
 	MOVQ CX, 80(BP)		
 	MOVQ DX, 88(BP)		

 	MOVQ b+16(FP), SI
	MOVQ 96(DI), R8		
 	MOVQ 104(DI), R9		
 	MOVQ 112(DI), R10		
 	MOVQ 120(DI), R11		
 	MOVQ 128(DI), R12		
 	MOVQ 136(DI), R13		
 	MOVQ 144(DI), R14		
 	MOVQ 152(DI), R15		
 	MOVQ 160(DI), AX		
 	MOVQ 168(DI), BX		
 	MOVQ 176(DI), CX		
 	MOVQ 184(DI), DX		

 	SUBQ 96(SI), R8		
 	SBBQ 104(SI), R9		
 	SBBQ 112(SI), R10		
 	SBBQ 120(SI), R11		
 	SBBQ 128(SI), R12		
 	SBBQ 136(SI), R13		
 	SBBQ 144(SI), R14		
 	SBBQ 152(SI), R15		
 	SBBQ 160(SI), AX		
 	SBBQ 168(SI), BX		
 	SBBQ 176(SI), CX		
 	SBBQ 184(SI), DX		

 	MOVQ R8, 96(BP)		
 	MOVQ R9, 104(BP)		
 	MOVQ R10, 112(BP)		
 	MOVQ R11, 120(BP)		
 	MOVQ R12, 128(BP)		
 	MOVQ R13, 136(BP)		

  MOVQ $0, SI
 	MOVQ $0xb9feffffffffaaab, R8		
 	MOVQ $0x1eabfffeb153ffff, R9		
 	MOVQ $0x6730d2a0f6b0f624, R10		
 	MOVQ $0x64774b84f38512bf, R11		
 	MOVQ $0x4b1ba7b6434bacd7, R12		
 	MOVQ $0x1a0111ea397fe69a, R13		
 	CMOVQCC SI, R8		
 	CMOVQCC SI, R9		
 	CMOVQCC SI, R10		
 	CMOVQCC SI, R11		
 	CMOVQCC SI, R12		
 	CMOVQCC SI, R13		
 	ADDQ R8, R14		
 	ADCQ R9, R15		
 	ADCQ R10, AX		
 	ADCQ R11, BX		
 	ADCQ R12, CX		
 	ADCQ R13, DX		
	
 	MOVQ R14, 144(BP)		
 	MOVQ R15, 152(BP)		
 	MOVQ AX, 160(BP)		
 	MOVQ BX, 168(BP)		
 	MOVQ CX, 176(BP)		
 	MOVQ DX, 184(BP)
 	RET


TEXT ·wfp2SubAssign(SB), NOSPLIT, $0-16
	
 	MOVQ a+0(FP), DI		
 	MOVQ b+8(FP), SI
	
 	MOVQ (DI), R8		
 	MOVQ 8(DI), R9		
 	MOVQ 16(DI), R10		
 	MOVQ 24(DI), R11		
 	MOVQ 32(DI), R12		
 	MOVQ 40(DI), R13		
 	MOVQ 48(DI), R14		
 	MOVQ 56(DI), R15		
 	MOVQ 64(DI), AX		
 	MOVQ 72(DI), BX		
 	MOVQ 80(DI), CX		
 	MOVQ 88(DI), DX		

 	SUBQ (SI), R8		
 	SBBQ 8(SI), R9		
 	SBBQ 16(SI), R10		
 	SBBQ 24(SI), R11		
 	SBBQ 32(SI), R12		
 	SBBQ 40(SI), R13		
 	SBBQ 48(SI), R14		
 	SBBQ 56(SI), R15		
 	SBBQ 64(SI), AX		
 	SBBQ 72(SI), BX		
 	SBBQ 80(SI), CX		
 	SBBQ 88(SI), DX		

 	MOVQ R8, (DI)		
 	MOVQ R9, 8(DI)		
 	MOVQ R10, 16(DI)		
 	MOVQ R11, 24(DI)		
 	MOVQ R12, 32(DI)		
 	MOVQ R13, 40(DI)		

  MOVQ $0, BP
 	MOVQ $0xb9feffffffffaaab, R8		
 	MOVQ $0x1eabfffeb153ffff, R9		
 	MOVQ $0x6730d2a0f6b0f624, R10		
 	MOVQ $0x64774b84f38512bf, R11		
 	MOVQ $0x4b1ba7b6434bacd7, R12		
 	MOVQ $0x1a0111ea397fe69a, R13		
 	CMOVQCC BP, R8		
 	CMOVQCC BP, R9		
 	CMOVQCC BP, R10		
 	CMOVQCC BP, R11		
 	CMOVQCC BP, R12		
 	CMOVQCC BP, R13		
 	ADDQ R8, R14		
 	ADCQ R9, R15		
 	ADCQ R10, AX		
 	ADCQ R11, BX		
 	ADCQ R12, CX		
 	ADCQ R13, DX		
	
 	MOVQ R14, 48(DI)		
 	MOVQ R15, 56(DI)		
 	MOVQ AX, 64(DI)		
 	MOVQ BX, 72(DI)		
 	MOVQ CX, 80(DI)		
 	MOVQ DX, 88(DI)

	MOVQ 96(DI), R8		
 	MOVQ 104(DI), R9		
 	MOVQ 112(DI), R10		
 	MOVQ 120(DI), R11		
 	MOVQ 128(DI), R12		
 	MOVQ 136(DI), R13		
 	MOVQ 144(DI), R14		
 	MOVQ 152(DI), R15		
 	MOVQ 160(DI), AX		
 	MOVQ 168(DI), BX		
 	MOVQ 176(DI), CX		
 	MOVQ 184(DI), DX		

 	SUBQ 96(SI), R8		
 	SBBQ 104(SI), R9		
 	SBBQ 112(SI), R10		
 	SBBQ 120(SI), R11		
 	SBBQ 128(SI), R12		
 	SBBQ 136(SI), R13		
 	SBBQ 144(SI), R14		
 	SBBQ 152(SI), R15		
 	SBBQ 160(SI), AX		
 	SBBQ 168(SI), BX		
 	SBBQ 176(SI), CX		
 	SBBQ 184(SI), DX		

 	MOVQ R8, 96(DI)		
 	MOVQ R9, 104(DI)		
 	MOVQ R10, 112(DI)		
 	MOVQ R11, 120(DI)		
 	MOVQ R12, 128(DI)		
 	MOVQ R13, 136(DI)		

  MOVQ $0, BP
 	MOVQ $0xb9feffffffffaaab, R8		
 	MOVQ $0x1eabfffeb153ffff, R9		
 	MOVQ $0x6730d2a0f6b0f624, R10		
 	MOVQ $0x64774b84f38512bf, R11		
 	MOVQ $0x4b1ba7b6434bacd7, R12		
 	MOVQ $0x1a0111ea397fe69a, R13		
 	CMOVQCC BP, R8		
 	CMOVQCC BP, R9		
 	CMOVQCC BP, R10		
 	CMOVQCC BP, R11		
 	CMOVQCC BP, R12		
 	CMOVQCC BP, R13		
 	ADDQ R8, R14		
 	ADCQ R9, R15		
 	ADCQ R10, AX		
 	ADCQ R11, BX		
 	ADCQ R12, CX		
 	ADCQ R13, DX		
	
 	MOVQ R14, 144(DI)		
 	MOVQ R15, 152(DI)		
 	MOVQ AX, 160(DI)		
 	MOVQ BX, 168(DI)		
 	MOVQ CX, 176(DI)		
 	MOVQ DX, 184(DI)
 	RET

TEXT ·wfp2SubMixed(SB), NOSPLIT, $0-24
	
 	MOVQ a+8(FP), DI		
 	MOVQ b+16(FP), SI
	
 	MOVQ (DI), R8		
 	MOVQ 8(DI), R9		
 	MOVQ 16(DI), R10		
 	MOVQ 24(DI), R11		
 	MOVQ 32(DI), R12		
 	MOVQ 40(DI), R13		
 	MOVQ 48(DI), R14		
 	MOVQ 56(DI), R15		
 	MOVQ 64(DI), AX		
 	MOVQ 72(DI), BX		
 	MOVQ 80(DI), CX		
 	MOVQ 88(DI), DX		

 	SUBQ (SI), R8		
 	SBBQ 8(SI), R9		
 	SBBQ 16(SI), R10		
 	SBBQ 24(SI), R11		
 	SBBQ 32(SI), R12		
 	SBBQ 40(SI), R13		
 	SBBQ 48(SI), R14		
 	SBBQ 56(SI), R15		
 	SBBQ 64(SI), AX		
 	SBBQ 72(SI), BX		
 	SBBQ 80(SI), CX		
 	SBBQ 88(SI), DX		

 	MOVQ c+0(FP), DI
 	MOVQ R8, (DI)		
 	MOVQ R9, 8(DI)		
 	MOVQ R10, 16(DI)		
 	MOVQ R11, 24(DI)		
 	MOVQ R12, 32(DI)		
 	MOVQ R13, 40(DI)		

  MOVQ $0, BP
 	MOVQ $0xb9feffffffffaaab, R8		
 	MOVQ $0x1eabfffeb153ffff, R9		
 	MOVQ $0x6730d2a0f6b0f624, R10		
 	MOVQ $0x64774b84f38512bf, R11		
 	MOVQ $0x4b1ba7b6434bacd7, R12		
 	MOVQ $0x1a0111ea397fe69a, R13		
 	CMOVQCC BP, R8		
 	CMOVQCC BP, R9		
 	CMOVQCC BP, R10		
 	CMOVQCC BP, R11		
 	CMOVQCC BP, R12		
 	CMOVQCC BP, R13		
 	ADDQ R8, R14		
 	ADCQ R9, R15		
 	ADCQ R10, AX		
 	ADCQ R11, BX		
 	ADCQ R12, CX		
 	ADCQ R13, DX		
	
 	MOVQ R14, 48(DI)		
 	MOVQ R15, 56(DI)		
 	MOVQ AX, 64(DI)		
 	MOVQ BX, 72(DI)		
 	MOVQ CX, 80(DI)		
 	MOVQ DX, 88(DI)

 	MOVQ a+8(FP), DI
	MOVQ 96(DI), R8		
 	MOVQ 104(DI), R9		
 	MOVQ 112(DI), R10		
 	MOVQ 120(DI), R11		
 	MOVQ 128(DI), R12		
 	MOVQ 136(DI), R13		
 	MOVQ 144(DI), R14		
 	MOVQ 152(DI), R15		
 	MOVQ 160(DI), AX		
 	MOVQ 168(DI), BX		
 	MOVQ 176(DI), CX		
 	MOVQ 184(DI), DX		

 	SUBQ 96(SI), R8		
 	SBBQ 104(SI), R9		
 	SBBQ 112(SI), R10		
 	SBBQ 120(SI), R11		
 	SBBQ 128(SI), R12		
 	SBBQ 136(SI), R13		
 	SBBQ 144(SI), R14		
 	SBBQ 152(SI), R15		
 	SBBQ 160(SI), AX		
 	SBBQ 168(SI), BX		
 	SBBQ 176(SI), CX		
 	SBBQ 184(SI), DX		

 	MOVQ c+0(FP), DI
 	MOVQ R8, 96(DI)		
 	MOVQ R9, 104(DI)		
 	MOVQ R10, 112(DI)		
 	MOVQ R11, 120(DI)		
 	MOVQ R12, 128(DI)		
 	MOVQ R13, 136(DI)	
 	MOVQ R14, 144(DI)		
 	MOVQ R15, 152(DI)		
 	MOVQ AX, 160(DI)		
 	MOVQ BX, 168(DI)		
 	MOVQ CX, 176(DI)		
 	MOVQ DX, 184(DI)
 	RET

TEXT ·wfp2SubMixedAssign(SB), NOSPLIT, $0-16
	
 	MOVQ a+0(FP), DI		
 	MOVQ b+8(FP), SI
	
 	MOVQ (DI), R8		
 	MOVQ 8(DI), R9		
 	MOVQ 16(DI), R10		
 	MOVQ 24(DI), R11		
 	MOVQ 32(DI), R12		
 	MOVQ 40(DI), R13		
 	MOVQ 48(DI), R14		
 	MOVQ 56(DI), R15		
 	MOVQ 64(DI), AX		
 	MOVQ 72(DI), BX		
 	MOVQ 80(DI), CX		
 	MOVQ 88(DI), DX		

 	SUBQ (SI), R8		
 	SBBQ 8(SI), R9		
 	SBBQ 16(SI), R10		
 	SBBQ 24(SI), R11		
 	SBBQ 32(SI), R12		
 	SBBQ 40(SI), R13		
 	SBBQ 48(SI), R14		
 	SBBQ 56(SI), R15		
 	SBBQ 64(SI), AX		
 	SBBQ 72(SI), BX		
 	SBBQ 80(SI), CX		
 	SBBQ 88(SI), DX		

 	MOVQ R8, (DI)		
 	MOVQ R9, 8(DI)		
 	MOVQ R10, 16(DI)		
 	MOVQ R11, 24(DI)		
 	MOVQ R12, 32(DI)		
 	MOVQ R13, 40(DI)		

  MOVQ $0, BP
 	MOVQ $0xb9feffffffffaaab, R8		
 	MOVQ $0x1eabfffeb153ffff, R9		
 	MOVQ $0x6730d2a0f6b0f624, R10		
 	MOVQ $0x64774b84f38512bf, R11		
 	MOVQ $0x4b1ba7b6434bacd7, R12		
 	MOVQ $0x1a0111ea397fe69a, R13		
 	CMOVQCC BP, R8		
 	CMOVQCC BP, R9		
 	CMOVQCC BP, R10		
 	CMOVQCC BP, R11		
 	CMOVQCC BP, R12		
 	CMOVQCC BP, R13		
 	ADDQ R8, R14		
 	ADCQ R9, R15		
 	ADCQ R10, AX		
 	ADCQ R11, BX		
 	ADCQ R12, CX		
 	ADCQ R13, DX
	
 	MOVQ R14, 48(DI)		
 	MOVQ R15, 56(DI)		
 	MOVQ AX, 64(DI)		
 	MOVQ BX, 72(DI)		
 	MOVQ CX, 80(DI)		
 	MOVQ DX, 88(DI)

	MOVQ 96(DI), R8		
 	MOVQ 104(DI), R9		
 	MOVQ 112(DI), R10		
 	MOVQ 120(DI), R11		
 	MOVQ 128(DI), R12		
 	MOVQ 136(DI), R13		
 	MOVQ 144(DI), R14		
 	MOVQ 152(DI), R15		
 	MOVQ 160(DI), AX		
 	MOVQ 168(DI), BX		
 	MOVQ 176(DI), CX		
 	MOVQ 184(DI), DX		

 	SUBQ 96(SI), R8		
 	SBBQ 104(SI), R9		
 	SBBQ 112(SI), R10		
 	SBBQ 120(SI), R11		
 	SBBQ 128(SI), R12		
 	SBBQ 136(SI), R13		
 	SBBQ 144(SI), R14		
 	SBBQ 152(SI), R15		
 	SBBQ 160(SI), AX		
 	SBBQ 168(SI), BX		
 	SBBQ 176(SI), CX		
 	SBBQ 184(SI), DX		

 	MOVQ R8, 96(DI)		
 	MOVQ R9, 104(DI)		
 	MOVQ R10, 112(DI)		
 	MOVQ R11, 120(DI)		
 	MOVQ R12, 128(DI)		
 	MOVQ R13, 136(DI)	
 	MOVQ R14, 144(DI)		
 	MOVQ R15, 152(DI)		
 	MOVQ AX, 160(DI)		
 	MOVQ BX, 168(DI)		
 	MOVQ CX, 176(DI)		
 	MOVQ DX, 184(DI)
 	RET	


TEXT ·wfp2Double(SB), NOSPLIT, $0-16		
	
 	MOVQ a+8(FP), DI		
	
 	MOVQ (DI), R8		
 	MOVQ 8(DI), R9		
 	MOVQ 16(DI), R10		
 	MOVQ 24(DI), R11		
 	MOVQ 32(DI), R12		
 	MOVQ 40(DI), R13		
 	MOVQ 48(DI), R14		
 	MOVQ 56(DI), R15		
 	MOVQ 64(DI), AX		
 	MOVQ 72(DI), BX		
 	MOVQ 80(DI), CX		
 	MOVQ 88(DI), DX		

 	ADDQ R8, R8		
 	ADCQ R9, R9		
 	ADCQ R10, R10		
 	ADCQ R11, R11		
 	ADCQ R12, R12		
 	ADCQ R13, R13		
 	ADCQ R14, R14		
 	ADCQ R15, R15		
 	ADCQ AX, AX		
 	ADCQ BX, BX		
 	ADCQ CX, CX		
 	ADCQ DX, DX		
	
 	MOVQ c+0(FP), SI		
 	MOVQ R8, (SI)		
 	MOVQ R9, 8(SI)		
 	MOVQ R10, 16(SI)		
 	MOVQ R11, 24(SI)		
 	MOVQ R12, 32(SI)		
 	MOVQ R13, 40(SI)		
	
 	MOVQ R14, R8		
 	MOVQ R15, R9		
 	MOVQ AX, R10		
 	MOVQ BX, R11		
 	MOVQ CX, R12
 	MOVQ DX, R13
	MOVQ $0xb9feffffffffaaab, BP
	SUBQ BP, R8
	MOVQ $0x1eabfffeb153ffff, BP
	SBBQ BP, R9
	MOVQ $0x6730d2a0f6b0f624, BP
	SBBQ BP, R10
	MOVQ $0x64774b84f38512bf, BP
	SBBQ BP, R11
	MOVQ $0x4b1ba7b6434bacd7, BP
	SBBQ BP, R12
	MOVQ $0x1a0111ea397fe69a, BP
	SBBQ BP, R13
 	CMOVQCC R8, R14		
 	CMOVQCC R9, R15		
 	CMOVQCC R10, AX		
 	CMOVQCC R11, BX		
 	CMOVQCC R12, CX		
 	CMOVQCC R13, DX		
	
 	MOVQ R14, 48(SI)		
 	MOVQ R15, 56(SI)		
 	MOVQ AX, 64(SI)		
 	MOVQ BX, 72(SI)		
 	MOVQ CX, 80(SI)		
 	MOVQ DX, 88(SI)

	MOVQ 96(DI), R8		
 	MOVQ 104(DI), R9		
 	MOVQ 112(DI), R10		
 	MOVQ 120(DI), R11		
 	MOVQ 128(DI), R12		
 	MOVQ 136(DI), R13		
 	MOVQ 144(DI), R14		
 	MOVQ 152(DI), R15		
 	MOVQ 160(DI), AX		
 	MOVQ 168(DI), BX		
 	MOVQ 176(DI), CX		
 	MOVQ 184(DI), DX		

 	ADDQ R8, R8		
 	ADCQ R9, R9		
 	ADCQ R10, R10		
 	ADCQ R11, R11		
 	ADCQ R12, R12		
 	ADCQ R13, R13		
 	ADCQ R14, R14		
 	ADCQ R15, R15		
 	ADCQ AX, AX		
 	ADCQ BX, BX		
 	ADCQ CX, CX		
 	ADCQ DX, DX		
	
 	MOVQ c+0(FP), SI		
 	MOVQ R8, 96(SI)		
 	MOVQ R9, 104(SI)		
 	MOVQ R10, 112(SI)		
 	MOVQ R11, 120(SI)		
 	MOVQ R12, 128(SI)		
 	MOVQ R13, 136(SI)		
	
 	MOVQ R14, R8		
 	MOVQ R15, R9		
 	MOVQ AX, R10		
 	MOVQ BX, R11		
 	MOVQ CX, R12		
 	MOVQ DX, R13
	MOVQ $0xb9feffffffffaaab, DI
	SUBQ DI, R8
	MOVQ $0x1eabfffeb153ffff, DI
	SBBQ DI, R9
	MOVQ $0x6730d2a0f6b0f624, DI
	SBBQ DI, R10
	MOVQ $0x64774b84f38512bf, DI
	SBBQ DI, R11
	MOVQ $0x4b1ba7b6434bacd7, DI
	SBBQ DI, R12
	MOVQ $0x1a0111ea397fe69a, DI
	SBBQ DI, R13
 	CMOVQCC R8, R14		
 	CMOVQCC R9, R15		
 	CMOVQCC R10, AX		
 	CMOVQCC R11, BX		
 	CMOVQCC R12, CX
 	CMOVQCC R13, DX		
	
 	MOVQ R14, 144(SI)		
 	MOVQ R15, 152(SI)		
 	MOVQ AX, 160(SI)		
 	MOVQ BX, 168(SI)		
 	MOVQ CX, 176(SI)		
 	MOVQ DX, 184(SI)	
 	RET

 TEXT ·wfp2DoubleAssign(SB), NOSPLIT, $0-8
 	MOVQ a+0(FP), DI		
	
 	MOVQ (DI), R8		
 	MOVQ 8(DI), R9		
 	MOVQ 16(DI), R10		
 	MOVQ 24(DI), R11		
 	MOVQ 32(DI), R12		
 	MOVQ 40(DI), R13		
 	MOVQ 48(DI), R14		
 	MOVQ 56(DI), R15		
 	MOVQ 64(DI), AX		
 	MOVQ 72(DI), BX		
 	MOVQ 80(DI), CX		
 	MOVQ 88(DI), DX		

 	ADDQ R8, R8		
 	ADCQ R9, R9		
 	ADCQ R10, R10		
 	ADCQ R11, R11		
 	ADCQ R12, R12		
 	ADCQ R13, R13		
 	ADCQ R14, R14		
 	ADCQ R15, R15		
 	ADCQ AX, AX		
 	ADCQ BX, BX		
 	ADCQ CX, CX		
 	ADCQ DX, DX		
	
 	MOVQ R8, (DI)		
 	MOVQ R9, 8(DI)		
 	MOVQ R10, 16(DI)		
 	MOVQ R11, 24(DI)		
 	MOVQ R12, 32(DI)		
 	MOVQ R13, 40(DI)		
	
 	MOVQ R14, R8		
 	MOVQ R15, R9		
 	MOVQ AX, R10		
 	MOVQ BX, R11		
 	MOVQ CX, R12		
 	MOVQ DX, R13
	MOVQ $0xb9feffffffffaaab, SI
	SUBQ SI, R8
	MOVQ $0x1eabfffeb153ffff, SI
	SBBQ SI, R9
	MOVQ $0x6730d2a0f6b0f624, SI
	SBBQ SI, R10
	MOVQ $0x64774b84f38512bf, SI
	SBBQ SI, R11
	MOVQ $0x4b1ba7b6434bacd7, SI
	SBBQ SI, R12
	MOVQ $0x1a0111ea397fe69a, SI
	SBBQ SI, R13	
 	CMOVQCC R8, R14		
 	CMOVQCC R9, R15		
 	CMOVQCC R10, AX		
 	CMOVQCC R11, BX		
 	CMOVQCC R12, CX		
 	CMOVQCC R13, DX		
	
 	MOVQ R14, 48(DI)		
 	MOVQ R15, 56(DI)		
 	MOVQ AX, 64(DI)		
 	MOVQ BX, 72(DI)		
 	MOVQ CX, 80(DI)		
 	MOVQ DX, 88(DI)

	MOVQ 96(DI), R8		
 	MOVQ 104(DI), R9		
 	MOVQ 112(DI), R10		
 	MOVQ 120(DI), R11		
 	MOVQ 128(DI), R12		
 	MOVQ 136(DI), R13		
 	MOVQ 144(DI), R14		
 	MOVQ 152(DI), R15		
 	MOVQ 160(DI), AX		
 	MOVQ 168(DI), BX		
 	MOVQ 176(DI), CX		
 	MOVQ 184(DI), DX		

 	ADDQ R8, R8		
 	ADCQ R9, R9		
 	ADCQ R10, R10		
 	ADCQ R11, R11		
 	ADCQ R12, R12		
 	ADCQ R13, R13		
 	ADCQ R14, R14		
 	ADCQ R15, R15		
 	ADCQ AX, AX		
 	ADCQ BX, BX		
 	ADCQ CX, CX		
 	ADCQ DX, DX		
	
 	MOVQ R8, 96(DI)		
 	MOVQ R9, 104(DI)		
 	MOVQ R10, 112(DI)		
 	MOVQ R11, 120(DI)		
 	MOVQ R12, 128(DI)		
 	MOVQ R13, 136(DI)		
	
 	MOVQ R14, R8		
 	MOVQ R15, R9		
 	MOVQ AX, R10		
 	MOVQ BX, R11		
 	MOVQ CX, R12		
 	MOVQ DX, R13
	MOVQ $0xb9feffffffffaaab, SI
	SUBQ SI, R8
	MOVQ $0x1eabfffeb153ffff, SI
	SBBQ SI, R9
	MOVQ $0x6730d2a0f6b0f624, SI
	SBBQ SI, R10
	MOVQ $0x64774b84f38512bf, SI
	SBBQ SI, R11
	MOVQ $0x4b1ba7b6434bacd7, SI
	SBBQ SI, R12
	MOVQ $0x1a0111ea397fe69a, SI
	SBBQ SI, R13	
 	CMOVQCC R8, R14		
 	CMOVQCC R9, R15		
 	CMOVQCC R10, AX		
 	CMOVQCC R11, BX		
 	CMOVQCC R12, CX
 	CMOVQCC R13, DX		
	
 	MOVQ R14, 144(DI)		
 	MOVQ R15, 152(DI)		
 	MOVQ AX, 160(DI)		
 	MOVQ BX, 168(DI)		
 	MOVQ CX, 176(DI)		
 	MOVQ DX, 184(DI)	
 	RET



// c1 = a0 + a1
// c0 = a0 - a1
TEXT ·wfp2MulByNonResidue(SB), NOSPLIT, $0-16
	MOVQ c+0(FP), SI
 	MOVQ a+8(FP), DI

	// a0 - a1
	MOVQ (DI), R8		
 	MOVQ 8(DI), R9		
 	MOVQ 16(DI), R10		
 	MOVQ 24(DI), R11		
 	MOVQ 32(DI), R12		
 	MOVQ 40(DI), R13		
 	MOVQ 48(DI), R14		
 	MOVQ 56(DI), R15		
 	MOVQ 64(DI), AX		
 	MOVQ 72(DI), BX		
 	MOVQ 80(DI), CX		
 	MOVQ 88(DI), DX

	SUBQ 96(DI), R8		
 	SBBQ 104(DI), R9		
 	SBBQ 112(DI), R10		
 	SBBQ 120(DI), R11		
 	SBBQ 128(DI), R12		
 	SBBQ 136(DI), R13		
 	SBBQ 144(DI), R14		
 	SBBQ 152(DI), R15		
 	SBBQ 160(DI), AX		
 	SBBQ 168(DI), BX		
 	SBBQ 176(DI), CX		
 	SBBQ 184(DI), DX		

 	MOVQ R8, (SI)		
 	MOVQ R9, 8(SI)		
 	MOVQ R10, 16(SI)		
 	MOVQ R11, 24(SI)		
 	MOVQ R12, 32(SI)		
 	MOVQ R13, 40(SI)		

  MOVQ $0, BP
 	MOVQ $0xb9feffffffffaaab, R8		
 	MOVQ $0x1eabfffeb153ffff, R9		
 	MOVQ $0x6730d2a0f6b0f624, R10		
 	MOVQ $0x64774b84f38512bf, R11		
 	MOVQ $0x4b1ba7b6434bacd7, R12		
 	MOVQ $0x1a0111ea397fe69a, R13		
 	CMOVQCC BP, R8		
 	CMOVQCC BP, R9		
 	CMOVQCC BP, R10		
 	CMOVQCC BP, R11		
 	CMOVQCC BP, R12		
 	CMOVQCC BP, R13		
 	ADDQ R8, R14		
 	ADCQ R9, R15		
 	ADCQ R10, AX		
 	ADCQ R11, BX		
 	ADCQ R12, CX		
 	ADCQ R13, DX		
	
 	MOVQ R14, 48(SI)		
 	MOVQ R15, 56(SI)		
 	MOVQ AX, 64(SI)		
 	MOVQ BX, 72(SI)		
 	MOVQ CX, 80(SI)		
 	MOVQ DX, 88(SI)

	// a0 + a1
	MOVQ (DI), R8		
 	MOVQ 8(DI), R9		
 	MOVQ 16(DI), R10		
 	MOVQ 24(DI), R11		
 	MOVQ 32(DI), R12		
 	MOVQ 40(DI), R13		
 	MOVQ 48(DI), R14		
 	MOVQ 56(DI), R15		
 	MOVQ 64(DI), AX		
 	MOVQ 72(DI), BX		
 	MOVQ 80(DI), CX		
 	MOVQ 88(DI), DX		

 	ADDQ 96(DI), R8		
 	ADCQ 104(DI), R9		
 	ADCQ 112(DI), R10		
 	ADCQ 120(DI), R11		
 	ADCQ 128(DI), R12		
 	ADCQ 136(DI), R13		
 	ADCQ 144(DI), R14		
 	ADCQ 152(DI), R15		
 	ADCQ 160(DI), AX		
 	ADCQ 168(DI), BX		
 	ADCQ 176(DI), CX		
 	ADCQ 184(DI), DX		

 	MOVQ R8, 96(SI)		
 	MOVQ R9, 104(SI)		
 	MOVQ R10, 112(SI)		
 	MOVQ R11, 120(SI)		
 	MOVQ R12, 128(SI)		
 	MOVQ R13, 136(SI)		

  MOVQ R14, R8		
 	MOVQ R15, R9		
 	MOVQ AX, R10		
 	MOVQ BX, R11		
 	MOVQ CX, R12		
 	MOVQ DX, R13		
 	MOVQ $0xb9feffffffffaaab, BP
	SUBQ BP, R8
	MOVQ $0x1eabfffeb153ffff, BP
	SBBQ BP, R9
	MOVQ $0x6730d2a0f6b0f624, BP
	SBBQ BP, R10
	MOVQ $0x64774b84f38512bf, BP
	SBBQ BP, R11
	MOVQ $0x4b1ba7b6434bacd7, BP
	SBBQ BP, R12
	MOVQ $0x1a0111ea397fe69a, BP
	SBBQ BP, R13
 	CMOVQCC R8, R14		
 	CMOVQCC R9, R15		
 	CMOVQCC R10, AX		
 	CMOVQCC R11, BX		
 	CMOVQCC R12, CX		
 	CMOVQCC R13, DX
 	MOVQ R14, 144(SI)		
 	MOVQ R15, 152(SI)		
 	MOVQ AX, 160(SI)		
 	MOVQ BX, 168(SI)		
 	MOVQ CX, 176(SI)		
 	MOVQ DX, 184(SI)

 	RET


TEXT ·wfp2MulByNonResidueAssign(SB), NOSPLIT, $64-8
	MOVQ a+0(FP), DI

	// a0 - a1
	MOVQ (DI), R8		
 	MOVQ 8(DI), R9		
 	MOVQ 16(DI), R10		
 	MOVQ 24(DI), R11		
 	MOVQ 32(DI), R12		
 	MOVQ 40(DI), R13		
 	MOVQ 48(DI), R14		
 	MOVQ 56(DI), R15		
 	MOVQ 64(DI), AX		
 	MOVQ 72(DI), BX		
 	MOVQ 80(DI), CX		
 	MOVQ 88(DI), DX

	SUBQ 96(DI), R8		
 	SBBQ 104(DI), R9		
 	SBBQ 112(DI), R10		
 	SBBQ 120(DI), R11		
 	SBBQ 128(DI), R12		
 	SBBQ 136(DI), R13		
 	SBBQ 144(DI), R14		
 	SBBQ 152(DI), R15		
 	SBBQ 160(DI), AX		
 	SBBQ 168(DI), BX		
 	SBBQ 176(DI), CX		
 	SBBQ 184(DI), DX		

 	MOVQ R8, (SP)		
 	MOVQ R9, 8(SP)		
 	MOVQ R10, 16(SP)		
 	MOVQ R11, 24(SP)		
 	MOVQ R12, 32(SP)		
 	MOVQ R13, 40(SP)		

  MOVQ $0, BP
 	MOVQ $0xb9feffffffffaaab, R8		
 	MOVQ $0x1eabfffeb153ffff, R9		
 	MOVQ $0x6730d2a0f6b0f624, R10		
 	MOVQ $0x64774b84f38512bf, R11		
 	MOVQ $0x4b1ba7b6434bacd7, R12		
 	MOVQ $0x1a0111ea397fe69a, R13		
 	CMOVQCC BP, R8		
 	CMOVQCC BP, R9		
 	CMOVQCC BP, R10		
 	CMOVQCC BP, R11		
 	CMOVQCC BP, R12		
 	CMOVQCC BP, R13		
 	ADDQ R8, R14		
 	ADCQ R9, R15		
 	ADCQ R10, AX		
 	ADCQ R11, BX		
 	ADCQ R12, CX		
 	ADCQ R13, DX		


	MOVQ 48(DI), R8
 	MOVQ 56(DI), R9
 	MOVQ 64(DI), R10
 	MOVQ 72(DI), R11	
 	MOVQ 80(DI), R12	
 	MOVQ 88(DI), R13
	
 	MOVQ R14, 48(DI)		
 	MOVQ R15, 56(DI)		
 	MOVQ AX, 64(DI)		
 	MOVQ BX, 72(DI)		
 	MOVQ CX, 80(DI)		
 	MOVQ DX, 88(DI)

	// a0 + a1
	MOVQ (DI), R14
 	MOVQ 8(DI), R15
 	MOVQ 16(DI), AX
 	MOVQ 24(DI), BX
 	MOVQ 32(DI), CX
 	MOVQ 40(DI), DX
	

 	ADDQ 96(DI), R14
 	ADCQ 104(DI), R15
 	ADCQ 112(DI), AX
 	ADCQ 120(DI), BX
 	ADCQ 128(DI), CX
 	ADCQ 136(DI), DX
 	ADCQ 144(DI), R8
 	ADCQ 152(DI), R9
 	ADCQ 160(DI), R10
 	ADCQ 168(DI), R11
 	ADCQ 176(DI), R12
 	ADCQ 184(DI), R13

 	MOVQ R14, 96(DI)		
 	MOVQ R15, 104(DI)		
 	MOVQ AX, 112(DI)		
 	MOVQ BX, 120(DI)		
 	MOVQ CX, 128(DI)		
 	MOVQ DX, 136(DI)		

  MOVQ R8, R14
 	MOVQ R9, R15
 	MOVQ R10, AX
 	MOVQ R11, BX
 	MOVQ R12, CX
 	MOVQ R13, DX
 	MOVQ $0xb9feffffffffaaab, BP
	SUBQ BP, R14
	MOVQ $0x1eabfffeb153ffff, BP
	SBBQ BP, R15
	MOVQ $0x6730d2a0f6b0f624, BP
	SBBQ BP, AX
	MOVQ $0x64774b84f38512bf, BP
	SBBQ BP, BX
	MOVQ $0x4b1ba7b6434bacd7, BP
	SBBQ BP, CX
	MOVQ $0x1a0111ea397fe69a, BP
	SBBQ BP, DX
 	CMOVQCC R14, R8
 	CMOVQCC R15, R9
 	CMOVQCC AX, R10
 	CMOVQCC BX, R11
 	CMOVQCC CX, R12
 	CMOVQCC DX, R13
 	MOVQ R8, 144(DI)
 	MOVQ R9, 152(DI)
 	MOVQ R10, 160(DI)
 	MOVQ R11, 168(DI)
 	MOVQ R12, 176(DI)
 	MOVQ R13, 184(DI)

	MOVQ (SP), R8
 	MOVQ 8(SP), R9
 	MOVQ 16(SP), R10
 	MOVQ 24(SP), R11
 	MOVQ 32(SP), R12
 	MOVQ 40(SP), R13

	MOVQ R8, (DI)		
 	MOVQ R9, 8(DI)		
 	MOVQ R10, 16(DI)		
 	MOVQ R11, 24(DI)		
 	MOVQ R12, 32(DI)		
 	MOVQ R13, 40(DI)

 	RET


TEXT ·wfp2SquareADX(SB), NOSPLIT, $96-16
	MOVQ a+8(FP), DI

	// a0
 	MOVQ (DI), R8		
 	MOVQ 8(DI), R9		
 	MOVQ 16(DI), R10		
 	MOVQ 24(DI), R11		
 	MOVQ 32(DI), R12		
 	MOVQ 40(DI), R13

	// a1
 	MOVQ 48(DI), R15
 	MOVQ 56(DI), BX		
 	MOVQ 64(DI), CX		
 	MOVQ 72(DI), DX		
 	MOVQ 80(DI), SI		
 	MOVQ 88(DI), R14

	// a0 + a1
	ADDQ R8, R15
 	ADCQ R9, BX
 	ADCQ R10, CX
 	ADCQ R11, DX
 	ADCQ R12, SI
 	ADCQ R13, R14

	XORQ AX, AX

	// store a0 + a1
	MOVQ R15, (SP)
 	MOVQ BX, 8(SP)
 	MOVQ CX, 16(SP)
 	MOVQ DX, 24(SP)
 	MOVQ SI, 32(SP)
 	MOVQ R14, 40(SP)

	// a0 - a1
	SUBQ 48(DI), R8
	SBBQ 56(DI), R9
	SBBQ 64(DI), R10
	SBBQ 72(DI), R11
	SBBQ 80(DI), R12
	SBBQ 88(DI), R13


	MOVQ $0xb9feffffffffaaab, R14
	MOVQ $0x1eabfffeb153ffff, R15
	MOVQ $0x6730d2a0f6b0f624, CX
	MOVQ $0x64774b84f38512bf, DX
	MOVQ $0x4b1ba7b6434bacd7, SI
	MOVQ $0x1a0111ea397fe69a, BX
	CMOVQCC AX, R14
	CMOVQCC AX, R15
	CMOVQCC AX, CX
	CMOVQCC AX, DX
	CMOVQCC AX, SI
	CMOVQCC AX, BX
	ADDQ R14, R8
	ADCQ R15, R9
	ADCQ CX, R10
	ADCQ DX, R11
	ADCQ SI, R12
	ADCQ BX, R13

	// a0 - a1
	MOVQ R8, 48(SP)
 	MOVQ R9, 56(SP)
 	MOVQ R10, 64(SP)
 	MOVQ R11, 72(SP)
 	MOVQ R12, 80(SP)
 	MOVQ R13, 88(SP)

	// c0 = (a0 + a1)(a0 - a1)
	MOVQ c+0(FP), SI

/* i0                                   */

	XORQ BX, BX
	MOVQ 48(SP), DX

	// | a0 * b0
	MULXQ (SP), AX, CX
	MOVQ  AX, (SI)

	// | a0 * b1
	MULXQ 8(SP), AX, BP
	ADCXQ AX, CX

	// | a0 * b2
	MULXQ 16(SP), AX, R9
	ADCXQ AX, BP

	// | a0 * b3
	MULXQ 24(SP), AX, R10
	ADCXQ AX, R9

	// | a0 * b4
	MULXQ 32(SP), AX, R11
	ADCXQ AX, R10

	// | a0 * b5
	MULXQ 40(SP), AX, R12
	ADCXQ AX, R11
	ADCXQ BX, R12

/* i1                                   */

	MOVQ 56(SP), DX

	// | a1 * b0
	MULXQ (SP), AX, R13
	ADOXQ AX, CX
	ADCXQ R13, BP
	MOVQ  CX, 8(SI)

	// | a1 * b1
	MULXQ 8(SP), AX, R13
	ADOXQ AX, BP
	ADCXQ R13, R9

	// | a1 * b2
	MULXQ 16(SP), AX, R13
	ADOXQ AX, R9
	ADCXQ R13, R10

	// | a1 * b3
	MULXQ 24(SP), AX, R13
	ADOXQ AX, R10
	ADCXQ R13, R11

	// | a1 * b4
	MULXQ 32(SP), AX, R13
	ADOXQ AX, R11
	ADCXQ R13, R12

	// | a1 * b5
	MULXQ 40(SP), AX, R13
	ADOXQ AX, R12
	ADOXQ BX, R13
	ADCXQ BX, R13

/* i2                                   */

	MOVQ 64(SP), DX

	// | a2 * b0
	MULXQ (SP), AX, R14
	ADOXQ AX, BP
	ADCXQ R14, R9
  MOVQ  BP, 16(SI)

	// | a2 * b1
	MULXQ 8(SP), AX, R14
	ADOXQ AX, R9
	ADCXQ R14, R10

	// | a2 * b2
	MULXQ 16(SP), AX, R14
	ADOXQ AX, R10
	ADCXQ R14, R11

	// | a2 * b3
	MULXQ 24(SP), AX, R14
	ADOXQ AX, R11
	ADCXQ R14, R12

	// | a2 * b4
	MULXQ 32(SP), AX, R14
	ADOXQ AX, R12
	ADCXQ R14, R13

	// | a2 * b5
	MULXQ 40(SP), AX, R14
	ADOXQ AX, R13
	ADOXQ BX, R14
	ADCXQ BX, R14

/* i3                                   */

	MOVQ 72(SP), DX

	// | a3 * b0
	MULXQ (SP), AX, R15
	ADOXQ AX, R9
	ADCXQ R15, R10
  MOVQ  R9, 24(SI)

	// | a3 * b1
	MULXQ 8(SP), AX, R15
	ADOXQ AX, R10
	ADCXQ R15, R11

	// | a3 * b2
	MULXQ 16(SP), AX, R15
	ADOXQ AX, R11
	ADCXQ R15, R12

	// | a3 * b3
	MULXQ 24(SP), AX, R15
	ADOXQ AX, R12
	ADCXQ R15, R13

	// | a3 * b4
	MULXQ 32(SP), AX, R15
	ADOXQ AX, R13
	ADCXQ R15, R14

	// | a3 * b5
	MULXQ 40(SP), AX, R15
	ADOXQ AX, R14
	ADOXQ BX, R15
	ADCXQ BX, R15

/* i4                                   */

	MOVQ 80(SP), DX

	// | a4 * b0
	MULXQ (SP), AX, CX
	ADOXQ AX, R10
	ADCXQ CX, R11
  MOVQ  R10, 32(SI)

	// | a4 * b1
	MULXQ 8(SP), AX, CX
	ADOXQ AX, R11
	ADCXQ CX, R12

	// | a4 * b2
	MULXQ 16(SP), AX, CX
	ADOXQ AX, R12
	ADCXQ CX, R13

	// | a4 * b3
	MULXQ 24(SP), AX, CX
	ADOXQ AX, R13
	ADCXQ CX, R14

	// | a4 * b4
	MULXQ 32(SP), AX, CX
	ADOXQ AX, R14
	ADCXQ CX, R15

	// | a4 * b5
	MULXQ 40(SP), AX, CX
	ADOXQ AX, R15
	ADOXQ BX, CX
	ADCXQ BX, CX

/* i5                                   */

	MOVQ 88(SP), DX

	// | a5 * b0
	MULXQ (SP), AX, R8
	ADOXQ AX, R11
	ADCXQ R8, R12
  MOVQ  R11, 40(SI)

	// | a5 * b1
	MULXQ 8(SP), AX, R8
	ADOXQ AX, R12
	ADCXQ R8, R13

	// | a5 * b2
	MULXQ 16(SP), AX, R8
	ADOXQ AX, R13
	ADCXQ R8, R14

	// | a5 * b3
	MULXQ 24(SP), AX, R8
	ADOXQ AX, R14
	ADCXQ R8, R15

	// | a5 * b4
	MULXQ 32(SP), AX, R8
	ADOXQ AX, R15
	ADCXQ R8, CX

	// | a5 * b5
	MULXQ 40(SP), AX, R8
	ADOXQ AX, CX
	ADOXQ BX, R8
	ADCXQ BX, R8
	

	// w0 stored	
  MOVQ R12, 48(SI)
  MOVQ R13, 56(SI)
  MOVQ R14, 64(SI)
  MOVQ R15, 72(SI)
  MOVQ CX, 80(SI)
  MOVQ R8, 88(SI)


	// a0
	MOVQ (DI), R8
 	MOVQ 8(DI), R9
 	MOVQ 16(DI), R10
 	MOVQ 24(DI), R11
 	MOVQ 32(DI), R12
 	MOVQ 40(DI), R13

	// 2a0
	ADDQ R8, R8
	ADCQ R9, R9
	ADCQ R10, R10
	ADCQ R11, R11
	ADCQ R12, R12
	ADCQ R13, R13

	MOVQ R8, (SP)
 	MOVQ R9, 8(SP)
 	MOVQ R10, 16(SP)
 	MOVQ R11, 24(SP)
 	MOVQ R12, 32(SP)
 	MOVQ R13, 40(SP)

	XORQ BX, BX

/* i0                                   */

	MOVQ 48(DI), DX

	// | a0 * b0
	MULXQ (SP), AX, CX
	MOVQ  AX, 96(SI)

	// | a0 * b1
	MULXQ 8(SP), AX, BP
	ADCXQ AX, CX

	// | a0 * b2
	MULXQ 16(SP), AX, R9
	ADCXQ AX, BP

	// | a0 * b3
	MULXQ 24(SP), AX, R10
	ADCXQ AX, R9

	// | a0 * b4
	MULXQ 32(SP), AX, R11
	ADCXQ AX, R10

	// | a0 * b5
	MULXQ 40(SP), AX, R12
	ADCXQ AX, R11
	ADCXQ BX, R12

	// |

/* i1                                   */

	MOVQ 56(DI), DX

	// | a1 * b0
	MULXQ (SP), AX, R13
	ADOXQ AX, CX
	ADCXQ R13, BP
	MOVQ  CX, 104(SI)

	// | a1 * b1
	MULXQ 8(SP), AX, R13
	ADOXQ AX, BP
	ADCXQ R13, R9

	// | a1 * b2
	MULXQ 16(SP), AX, R13
	ADOXQ AX, R9
	ADCXQ R13, R10

	// | a1 * b3
	MULXQ 24(SP), AX, R13
	ADOXQ AX, R10
	ADCXQ R13, R11

	// | a1 * b4
	MULXQ 32(SP), AX, R13
	ADOXQ AX, R11
	ADCXQ R13, R12

	// | a1 * b5
	MULXQ 40(SP), AX, R13
	ADOXQ AX, R12
	ADOXQ BX, R13
	ADCXQ BX, R13

/* i2                                   */

	MOVQ 64(DI), DX

	// | a2 * b0
	MULXQ (SP), AX, R14
	ADOXQ AX, BP
	ADCXQ R14, R9
  MOVQ  BP, 112(SI)

	// | a2 * b1
	MULXQ 8(SP), AX, R14
	ADOXQ AX, R9
	ADCXQ R14, R10

	// | a2 * b2
	MULXQ 16(SP), AX, R14
	ADOXQ AX, R10
	ADCXQ R14, R11

	// | a2 * b3
	MULXQ 24(SP), AX, R14
	ADOXQ AX, R11
	ADCXQ R14, R12

	// | a2 * b4
	MULXQ 32(SP), AX, R14
	ADOXQ AX, R12
	ADCXQ R14, R13

	// | a2 * b5
	MULXQ 40(SP), AX, R14
	ADOXQ AX, R13
	ADOXQ BX, R14
	ADCXQ BX, R14

/* i3                                   */

	MOVQ 72(DI), DX

	// | a3 * b0
	MULXQ (SP), AX, R15
	ADOXQ AX, R9
	ADCXQ R15, R10
  MOVQ  R9, 120(SI)

	// | a3 * b1
	MULXQ 8(SP), AX, R15
	ADOXQ AX, R10
	ADCXQ R15, R11

	// | a3 * b2
	MULXQ 16(SP), AX, R15
	ADOXQ AX, R11
	ADCXQ R15, R12

	// | a3 * b3
	MULXQ 24(SP), AX, R15
	ADOXQ AX, R12
	ADCXQ R15, R13

	// | a3 * b4
	MULXQ 32(SP), AX, R15
	ADOXQ AX, R13
	ADCXQ R15, R14

	// | a3 * b5
	MULXQ 40(SP), AX, R15
	ADOXQ AX, R14
	ADOXQ BX, R15
	ADCXQ BX, R15

/* i4                                   */

	MOVQ 80(DI), DX

	// | a4 * b0
	MULXQ (SP), AX, CX
	ADOXQ AX, R10
	ADCXQ CX, R11
  MOVQ  R10, 128(SI)

	// | a4 * b1
	MULXQ 8(SP), AX, CX
	ADOXQ AX, R11
	ADCXQ CX, R12

	// | a4 * b2
	MULXQ 16(SP), AX, CX
	ADOXQ AX, R12
	ADCXQ CX, R13

	// | a4 * b3
	MULXQ 24(SP), AX, CX
	ADOXQ AX, R13
	ADCXQ CX, R14

	// | a4 * b4
	MULXQ 32(SP), AX, CX
	ADOXQ AX, R14
	ADCXQ CX, R15

	// | a4 * b5
	MULXQ 40(SP), AX, CX
	ADOXQ AX, R15
	ADOXQ BX, CX
	ADCXQ BX, CX

/* i5                                   */

	MOVQ 88(DI), DX

	// | a5 * b0
	MULXQ (SP), AX, DI
	ADOXQ AX, R11
	ADCXQ DI, R12
  MOVQ  R11, 136(SI)

	// | a5 * b1
	MULXQ 8(SP), AX, DI
	ADOXQ AX, R12
	ADCXQ DI, R13

	// | a5 * b2
	MULXQ 16(SP), AX, DI
	ADOXQ AX, R13
	ADCXQ DI, R14

	// | a5 * b3
	MULXQ 24(SP), AX, DI
	ADOXQ AX, R14
	ADCXQ DI, R15

	// | a5 * b4
	MULXQ 32(SP), AX, DI
	ADOXQ AX, R15
	ADCXQ DI, CX

	// | a5 * b5
	MULXQ 40(SP), AX, DI
	ADOXQ AX, CX
	ADOXQ BX, DI
	ADCXQ BX, DI

  MOVQ R12, 144(SI)
  MOVQ R13, 152(SI)
  MOVQ R14, 160(SI)
  MOVQ R15, 168(SI)
  MOVQ CX, 176(SI)
  MOVQ DI, 184(SI)
	RET


TEXT ·wfp2MulADX(SB), NOSPLIT, $192-24
	MOVQ a+8(FP), DI
	MOVQ b+16(FP), SI


// a0b0
/* i0                                   */
	XORQ BX, BX
	MOVQ (SI), DX

	// | a0 * b0
	MULXQ (DI), AX, CX
	MOVQ  AX, (SP)

	// | a0 * b1
	MULXQ 8(DI), AX, BP
	ADCXQ AX, CX

	// | a0 * b2
	MULXQ 16(DI), AX, R9
	ADCXQ AX, BP

	// | a0 * b3
	MULXQ 24(DI), AX, R10
	ADCXQ AX, R9

	// | a0 * b4
	MULXQ 32(DI), AX, R11
	ADCXQ AX, R10

	// | a0 * b5
	MULXQ 40(DI), AX, R12
	ADCXQ AX, R11
	ADCXQ BX, R12

/* i1                                   */

	MOVQ 8(SI), DX

	// | a1 * b0
	MULXQ (DI), AX, R13
	ADOXQ AX, CX
	ADCXQ R13, BP
	MOVQ  CX, 8(SP)

	// | a1 * b1
	MULXQ 8(DI), AX, R13
	ADOXQ AX, BP
	ADCXQ R13, R9

	// | a1 * b2
	MULXQ 16(DI), AX, R13
	ADOXQ AX, R9
	ADCXQ R13, R10

	// | a1 * b3
	MULXQ 24(DI), AX, R13
	ADOXQ AX, R10
	ADCXQ R13, R11

	// | a1 * b4
	MULXQ 32(DI), AX, R13
	ADOXQ AX, R11
	ADCXQ R13, R12

	// | a1 * b5
	MULXQ 40(DI), AX, R13
	ADOXQ AX, R12
	ADOXQ BX, R13
	ADCXQ BX, R13

/* i2                                   */

	MOVQ 16(SI), DX

	// | a2 * b0
	MULXQ (DI), AX, R14
	ADOXQ AX, BP
	ADCXQ R14, R9
  MOVQ  BP, 16(SP)

	// | a2 * b1
	MULXQ 8(DI), AX, R14
	ADOXQ AX, R9
	ADCXQ R14, R10

	// | a2 * b2
	MULXQ 16(DI), AX, R14
	ADOXQ AX, R10
	ADCXQ R14, R11

	// | a2 * b3
	MULXQ 24(DI), AX, R14
	ADOXQ AX, R11
	ADCXQ R14, R12

	// | a2 * b4
	MULXQ 32(DI), AX, R14
	ADOXQ AX, R12
	ADCXQ R14, R13

	// | a2 * b5
	MULXQ 40(DI), AX, R14
	ADOXQ AX, R13
	ADOXQ BX, R14
	ADCXQ BX, R14

/* i3                                   */

	MOVQ 24(SI), DX

	// | a3 * b0
	MULXQ (DI), AX, R15
	ADOXQ AX, R9
	ADCXQ R15, R10
  MOVQ  R9, 24(SP)

	// | a3 * b1
	MULXQ 8(DI), AX, R15
	ADOXQ AX, R10
	ADCXQ R15, R11

	// | a3 * b2
	MULXQ 16(DI), AX, R15
	ADOXQ AX, R11
	ADCXQ R15, R12

	// | a3 * b3
	MULXQ 24(DI), AX, R15
	ADOXQ AX, R12
	ADCXQ R15, R13

	// | a3 * b4
	MULXQ 32(DI), AX, R15
	ADOXQ AX, R13
	ADCXQ R15, R14

	// | a3 * b5
	MULXQ 40(DI), AX, R15
	ADOXQ AX, R14
	ADOXQ BX, R15
	ADCXQ BX, R15

/* i4                                   */

	MOVQ 32(SI), DX

	// | a4 * b0
	MULXQ (DI), AX, CX
	ADOXQ AX, R10
	ADCXQ CX, R11
  MOVQ  R10, 32(SP)

	// | a4 * b1
	MULXQ 8(DI), AX, CX
	ADOXQ AX, R11
	ADCXQ CX, R12

	// | a4 * b2
	MULXQ 16(DI), AX, CX
	ADOXQ AX, R12
	ADCXQ CX, R13

	// | a4 * b3
	MULXQ 24(DI), AX, CX
	ADOXQ AX, R13
	ADCXQ CX, R14

	// | a4 * b4
	MULXQ 32(DI), AX, CX
	ADOXQ AX, R14
	ADCXQ CX, R15

	// | a4 * b5
	MULXQ 40(DI), AX, CX
	ADOXQ AX, R15
	ADOXQ BX, CX
	ADCXQ BX, CX

/* i5                                   */


	MOVQ 40(SI), DX

	// | a5 * b0
	MULXQ (DI), AX, R8
	ADOXQ AX, R11
	ADCXQ R8, R12
  MOVQ  R11, 40(SP)

	// | a5 * b1
	MULXQ 8(DI), AX, R8
	ADOXQ AX, R12
	ADCXQ R8, R13

	// | a5 * b2
	MULXQ 16(DI), AX, R8
	ADOXQ AX, R13
	ADCXQ R8, R14

	// | a5 * b3
	MULXQ 24(DI), AX, R8
	ADOXQ AX, R14
	ADCXQ R8, R15

	// | a5 * b4
	MULXQ 32(DI), AX, R8
	ADOXQ AX, R15
	ADCXQ R8, CX

	// | a5 * b5
	MULXQ 40(DI), AX, R8
	ADOXQ AX, CX
	ADOXQ BX, R8
	ADCXQ BX, R8
	

	// a0b0 stored (0, 88)SP
  MOVQ R12, 48(SP)
  MOVQ R13, 56(SP)
  MOVQ R14, 64(SP)
  MOVQ R15, 72(SP)
  MOVQ CX, 80(SP)
  MOVQ R8, 88(SP)


// a1b1

/* i0                                   */
	XORQ BX, BX
	MOVQ 48(SI), DX

	// | a0 * b0
	MULXQ 48(DI), AX, CX
	MOVQ  AX, 96(SP)

	// | a0 * b1
	MULXQ 56(DI), AX, BP
	ADCXQ AX, CX

	// | a0 * b2
	MULXQ 64(DI), AX, R9
	ADCXQ AX, BP

	// | a0 * b3
	MULXQ 72(DI), AX, R10
	ADCXQ AX, R9

	// | a0 * b4
	MULXQ 80(DI), AX, R11
	ADCXQ AX, R10

	// | a0 * b5
	MULXQ 88(DI), AX, R12
	ADCXQ AX, R11
	ADCXQ BX, R12

/* i1                                   */

	MOVQ 56(SI), DX

	// | a1 * b0
	MULXQ 48(DI), AX, R13
	ADOXQ AX, CX
	ADCXQ R13, BP
	MOVQ  CX, 104(SP)

	// | a1 * b1
	MULXQ 56(DI), AX, R13
	ADOXQ AX, BP
	ADCXQ R13, R9

	// | a1 * b2
	MULXQ 64(DI), AX, R13
	ADOXQ AX, R9
	ADCXQ R13, R10

	// | a1 * b3
	MULXQ 72(DI), AX, R13
	ADOXQ AX, R10
	ADCXQ R13, R11

	// | a1 * b4
	MULXQ 80(DI), AX, R13
	ADOXQ AX, R11
	ADCXQ R13, R12

	// | a1 * b5
	MULXQ 88(DI), AX, R13
	ADOXQ AX, R12
	ADOXQ BX, R13
	ADCXQ BX, R13

/* i2                                   */

	MOVQ 64(SI), DX

	// | a2 * b0
	MULXQ 48(DI), AX, R14
	ADOXQ AX, BP
	ADCXQ R14, R9
  MOVQ  BP, 112(SP)

	// | a2 * b1
	MULXQ 56(DI), AX, R14
	ADOXQ AX, R9
	ADCXQ R14, R10

	// | a2 * b2
	MULXQ 64(DI), AX, R14
	ADOXQ AX, R10
	ADCXQ R14, R11

	// | a2 * b3
	MULXQ 72(DI), AX, R14
	ADOXQ AX, R11
	ADCXQ R14, R12

	// | a2 * b4
	MULXQ 80(DI), AX, R14
	ADOXQ AX, R12
	ADCXQ R14, R13

	// | a2 * b5
	MULXQ 88(DI), AX, R14
	ADOXQ AX, R13
	ADOXQ BX, R14
	ADCXQ BX, R14

/* i3                                   */

	MOVQ 72(SI), DX

	// | a3 * b0
	MULXQ 48(DI), AX, R15
	ADOXQ AX, R9
	ADCXQ R15, R10
  MOVQ  R9, 120(SP)

	// | a3 * b1
	MULXQ 56(DI), AX, R15
	ADOXQ AX, R10
	ADCXQ R15, R11

	// | a3 * b2
	MULXQ 64(DI), AX, R15
	ADOXQ AX, R11
	ADCXQ R15, R12

	// | a3 * b3
	MULXQ 72(DI), AX, R15
	ADOXQ AX, R12
	ADCXQ R15, R13

	// | a3 * b4
	MULXQ 80(DI), AX, R15
	ADOXQ AX, R13
	ADCXQ R15, R14

	// | a3 * b5
	MULXQ 88(DI), AX, R15
	ADOXQ AX, R14
	ADOXQ BX, R15
	ADCXQ BX, R15

/* i4                                   */

	MOVQ 80(SI), DX

	// | a4 * b0
	MULXQ 48(DI), AX, CX
	ADOXQ AX, R10
	ADCXQ CX, R11
  MOVQ  R10, 128(SP)

	// | a4 * b1
	MULXQ 56(DI), AX, CX
	ADOXQ AX, R11
	ADCXQ CX, R12

	// | a4 * b2
	MULXQ 64(DI), AX, CX
	ADOXQ AX, R12
	ADCXQ CX, R13

	// | a4 * b3
	MULXQ 72(DI), AX, CX
	ADOXQ AX, R13
	ADCXQ CX, R14

	// | a4 * b4
	MULXQ 80(DI), AX, CX
	ADOXQ AX, R14
	ADCXQ CX, R15

	// | a4 * b5
	MULXQ 88(DI), AX, CX
	ADOXQ AX, R15
	ADOXQ BX, CX
	ADCXQ BX, CX

/* i5                                   */

	MOVQ 88(SI), DX

	// | a5 * b0
	MULXQ 48(DI), AX, R8
	ADOXQ AX, R11
	ADCXQ R8, R12
  MOVQ  R11, 136(SP)

	// | a5 * b1
	MULXQ 56(DI), AX, R8
	ADOXQ AX, R12
	ADCXQ R8, R13

	// | a5 * b2
	MULXQ 64(DI), AX, R8
	ADOXQ AX, R13
	ADCXQ R8, R14

	// | a5 * b3
	MULXQ 72(DI), AX, R8
	ADOXQ AX, R14
	ADCXQ R8, R15

	// | a5 * b4
	MULXQ 80(DI), AX, R8
	ADOXQ AX, R15
	ADCXQ R8, CX

	// | a5 * b5
	MULXQ 88(DI), AX, R8
	ADOXQ AX, CX
	ADOXQ BX, R8
	ADCXQ BX, R8
	

// a1b1 stored	(96, 184)SP
  MOVQ R12, 144(SP)
  MOVQ R13, 152(SP)
  MOVQ R14, 160(SP)
  MOVQ R15, 168(SP)
  MOVQ CX, 176(SP)
  MOVQ R8, 184(SP)


// a0b0 - a1b1
	MOVQ (SP), R8		
 	MOVQ 8(SP), R9		
 	MOVQ 16(SP), R10		
 	MOVQ 24(SP), R11		
 	MOVQ 32(SP), R12		
 	MOVQ 40(SP), R13		
 	MOVQ 48(SP), R14		
 	MOVQ 56(SP), R15		
 	MOVQ 64(SP), AX		
 	MOVQ 72(SP), BX		
 	MOVQ 80(SP), CX		
 	MOVQ 88(SP), DX		
 	SUBQ 96(SP), R8		
 	SBBQ 104(SP), R9		
 	SBBQ 112(SP), R10		
 	SBBQ 120(SP), R11		
 	SBBQ 128(SP), R12		
 	SBBQ 136(SP), R13
	// todo this can be avoided
 	SBBQ 144(SP), R14		
 	SBBQ 152(SP), R15		
 	SBBQ 160(SP), AX		
 	SBBQ 168(SP), BX		
 	SBBQ 176(SP), CX	
 	SBBQ 184(SP), DX
	MOVQ c+0(FP), DI		
 	MOVQ R8, (DI)		
 	MOVQ R9, 8(DI)		
 	MOVQ R10, 16(DI)		
 	MOVQ R11, 24(DI)		
 	MOVQ R12, 32(DI)		
 	MOVQ R13, 40(DI)
	MOVQ $0, SI
 	MOVQ $0xb9feffffffffaaab, R8		
 	MOVQ $0x1eabfffeb153ffff, R9		
 	MOVQ $0x6730d2a0f6b0f624, R10		
 	MOVQ $0x64774b84f38512bf, R11		
 	MOVQ $0x4b1ba7b6434bacd7, R12		
 	MOVQ $0x1a0111ea397fe69a, R13		
 	CMOVQCC SI, R8		
 	CMOVQCC SI, R9		
 	CMOVQCC SI, R10		
 	CMOVQCC SI, R11		
 	CMOVQCC SI, R12		
 	CMOVQCC SI, R13		
 	ADDQ R8, R14		
 	ADCQ R9, R15		
 	ADCQ R10, AX		
 	ADCQ R11, BX		
 	ADCQ R12, CX		
 	ADCQ R13, DX		
 	MOVQ R14, 48(DI)		
 	MOVQ R15, 56(DI)		
 	MOVQ AX, 64(DI)		
 	MOVQ BX, 72(DI)		
 	MOVQ CX, 80(DI)		
 	MOVQ DX, 88(DI)

// a0b0 + a1b1
	MOVQ (SP), R8		
 	MOVQ 8(SP), R9		
 	MOVQ 16(SP), R10		
 	MOVQ 24(SP), R11		
 	MOVQ 32(SP), R12		
 	MOVQ 40(SP), R13		
 	MOVQ 48(SP), R14		
 	MOVQ 56(SP), R15		
 	MOVQ 64(SP), AX		
 	MOVQ 72(SP), BX		
 	MOVQ 80(SP), CX		
 	MOVQ 88(SP), DX		
 	ADDQ 96(SP), R8		
 	ADCQ 104(SP), R9		
 	ADCQ 112(SP), R10		
 	ADCQ 120(SP), R11		
 	ADCQ 128(SP), R12		
 	ADCQ 136(SP), R13
 	ADCQ 144(SP), R14		
 	ADCQ 152(SP), R15		
 	ADCQ 160(SP), AX		
 	ADCQ 168(SP), BX		
 	ADCQ 176(SP), CX	
 	ADCQ 184(SP), DX
	MOVQ R8, 96(SP)
 	MOVQ R9, 104(SP)
 	MOVQ R10, 112(SP)
 	MOVQ R11, 120(SP)
 	MOVQ R12, 128(SP)
 	MOVQ R13, 136(SP)
 	MOVQ R14, 144(SP)
 	MOVQ R15, 152(SP)
 	MOVQ AX, 160(SP)
 	MOVQ BX, 168(SP)
 	MOVQ CX, 176(SP)
 	MOVQ DX, 184(SP)
// a0b0 + a1b1 stored (96, 184)SP

// a0 + a1
	MOVQ a+8(FP), DI

	MOVQ (DI), R8
	MOVQ 8(DI), R9
	MOVQ 16(DI), R10
	MOVQ 24(DI), R11
	MOVQ 32(DI), R12
	MOVQ 40(DI), R13

	ADDQ 48(DI), R8
	ADCQ 56(DI), R9
	ADCQ 64(DI), R10
	ADCQ 72(DI), R11
	ADCQ 80(DI), R12
	ADCQ 88(DI), R13

	MOVQ R8, (SP)
 	MOVQ R9, 8(SP)
 	MOVQ R10, 16(SP)
 	MOVQ R11, 24(SP)
 	MOVQ R12, 32(SP)
 	MOVQ R13, 40(SP)
// a0 + a1 storeed (0, 40)SP
// b0 + b1
	MOVQ b+16(FP), DI

	MOVQ (DI), R8
	MOVQ 8(DI), R9
	MOVQ 16(DI), R10
	MOVQ 24(DI), R11
	MOVQ 32(DI), R12
	MOVQ 40(DI), R13

	ADDQ 48(DI), R8
	ADCQ 56(DI), R9
	ADCQ 64(DI), R10
	ADCQ 72(DI), R11
	ADCQ 80(DI), R12
	ADCQ 88(DI), R13

	MOVQ R8, 48(SP)
 	MOVQ R9, 56(SP)
 	MOVQ R10, 64(SP)
 	MOVQ R11, 72(SP)
 	MOVQ R12, 80(SP)
 	MOVQ R13, 88(SP)
// b0 + b1 storeed (48, 88)SP
// (a0 + a1)(b0 + b1)

/* i0                                   */
	XORQ BX, BX
	MOVQ (SP), DX

	// | a0 * b0
	MULXQ 48(SP), AX, CX
	MOVQ  AX, (SP)

	// | a0 * b1
	MULXQ 56(SP), AX, BP
	ADCXQ AX, CX

	// | a0 * b2
	MULXQ 64(SP), AX, R9
	ADCXQ AX, BP

	// | a0 * b3
	MULXQ 72(SP), AX, R10
	ADCXQ AX, R9

	// | a0 * b4
	MULXQ 80(SP), AX, R11
	ADCXQ AX, R10

	// | a0 * b5
	MULXQ 88(SP), AX, R12
	ADCXQ AX, R11
	ADCXQ BX, R12

/* i1                                   */

	MOVQ 8(SP), DX

	// | a1 * b0
	MULXQ 48(SP), AX, R13
	ADOXQ AX, CX
	ADCXQ R13, BP
	MOVQ  CX, 8(SP)

	// | a1 * b1
	MULXQ 56(SP), AX, R13
	ADOXQ AX, BP
	ADCXQ R13, R9

	// | a1 * b2
	MULXQ 64(SP), AX, R13
	ADOXQ AX, R9
	ADCXQ R13, R10

	// | a1 * b3
	MULXQ 72(SP), AX, R13
	ADOXQ AX, R10
	ADCXQ R13, R11

	// | a1 * b4
	MULXQ 80(SP), AX, R13
	ADOXQ AX, R11
	ADCXQ R13, R12

	// | a1 * b5
	MULXQ 88(SP), AX, R13
	ADOXQ AX, R12
	ADOXQ BX, R13
	ADCXQ BX, R13

/* i2                                   */

	MOVQ 16(SP), DX

	// | a2 * b0
	MULXQ 48(SP), AX, R14
	ADOXQ AX, BP
	ADCXQ R14, R9
  MOVQ  BP, 16(SP)

	// | a2 * b1
	MULXQ 56(SP), AX, R14
	ADOXQ AX, R9
	ADCXQ R14, R10

	// | a2 * b2
	MULXQ 64(SP), AX, R14
	ADOXQ AX, R10
	ADCXQ R14, R11

	// | a2 * b3
	MULXQ 72(SP), AX, R14
	ADOXQ AX, R11
	ADCXQ R14, R12

	// | a2 * b4
	MULXQ 80(SP), AX, R14
	ADOXQ AX, R12
	ADCXQ R14, R13

	// | a2 * b5
	MULXQ 88(SP), AX, R14
	ADOXQ AX, R13
	ADOXQ BX, R14
	ADCXQ BX, R14

/* i3                                   */

	MOVQ 24(SP), DX

	// | a3 * b0
	MULXQ 48(SP), AX, R15
	ADOXQ AX, R9
	ADCXQ R15, R10
  MOVQ  R9, 24(SP)

	// | a3 * b1
	MULXQ 56(SP), AX, R15
	ADOXQ AX, R10
	ADCXQ R15, R11

	// | a3 * b2
	MULXQ 64(SP), AX, R15
	ADOXQ AX, R11
	ADCXQ R15, R12

	// | a3 * b3
	MULXQ 72(SP), AX, R15
	ADOXQ AX, R12
	ADCXQ R15, R13

	// | a3 * b4
	MULXQ 80(SP), AX, R15
	ADOXQ AX, R13
	ADCXQ R15, R14

	// | a3 * b5
	MULXQ 88(SP), AX, R15
	ADOXQ AX, R14
	ADOXQ BX, R15
	ADCXQ BX, R15

/* i4                                   */

	MOVQ 32(SP), DX

	// | a4 * b0
	MULXQ 48(SP), AX, CX
	ADOXQ AX, R10
	ADCXQ CX, R11
  MOVQ  R10, 32(SP)

	// | a4 * b1
	MULXQ 56(SP), AX, CX
	ADOXQ AX, R11
	ADCXQ CX, R12

	// | a4 * b2
	MULXQ 64(SP), AX, CX
	ADOXQ AX, R12
	ADCXQ CX, R13

	// | a4 * b3
	MULXQ 72(SP), AX, CX
	ADOXQ AX, R13
	ADCXQ CX, R14

	// | a4 * b4
	MULXQ 80(SP), AX, CX
	ADOXQ AX, R14
	ADCXQ CX, R15

	// | a4 * b5
	MULXQ 88(SP), AX, CX
	ADOXQ AX, R15
	ADOXQ BX, CX
	ADCXQ BX, CX

/* i5                                   */

	MOVQ 40(SP), DX

	// | a5 * b0
	MULXQ 48(SP), AX, R8
	ADOXQ AX, R11
	ADCXQ R8, R12
  MOVQ  R11, 40(SP)

	// | a5 * b1
	MULXQ 56(SP), AX, R8
	ADOXQ AX, R12
	ADCXQ R8, R13

	// | a5 * b2
	MULXQ 64(SP), AX, R8
	ADOXQ AX, R13
	ADCXQ R8, R14

	// | a5 * b3
	MULXQ 72(SP), AX, R8
	ADOXQ AX, R14
	ADCXQ R8, R15

	// | a5 * b4
	MULXQ 80(SP), AX, R8
	ADOXQ AX, R15
	ADCXQ R8, CX

	// | a5 * b5
	MULXQ 88(SP), AX, R8
	ADOXQ AX, CX
	ADOXQ BX, R8
	ADCXQ BX, R8

  MOVQ  R12, 48(SP)
  MOVQ  R13, 56(SP)
  MOVQ  R14, 64(SP)
  MOVQ  R15, 72(SP)
  MOVQ  CX, 80(SP)
  MOVQ  R8, 88(SP)


// (a0 + a1)(b0 + b1) - (a0b0 + a1b1)
	MOVQ (SP), R8
 	MOVQ 8(SP), R9
 	MOVQ 16(SP), R10
 	MOVQ 24(SP), R11
 	MOVQ 32(SP), R12
 	MOVQ 40(SP), R13
 	MOVQ 48(SP), R14
 	MOVQ 56(SP), R15
 	MOVQ 64(SP), AX
 	MOVQ 72(SP), BX
 	MOVQ 80(SP), CX
 	MOVQ 88(SP), DX

 	SUBQ 96(SP), R8
 	SBBQ 104(SP), R9
 	SBBQ 112(SP), R10
 	SBBQ 120(SP), R11
 	SBBQ 128(SP), R12
 	SBBQ 136(SP), R13
 	SBBQ 144(SP), R14
 	SBBQ 152(SP), R15
 	SBBQ 160(SP), AX
 	SBBQ 168(SP), BX
 	SBBQ 176(SP), CX
 	SBBQ 184(SP), DX
	
	MOVQ c+0(FP), DI	
 	MOVQ R8, 96(DI)		
 	MOVQ R9, 104(DI)		
 	MOVQ R10, 112(DI)		
 	MOVQ R11, 120(DI)		
 	MOVQ R12, 128(DI)		
 	MOVQ R13, 136(DI)
	MOVQ R14, 144(DI)
 	MOVQ R15, 152(DI)
 	MOVQ AX, 160(DI)
 	MOVQ BX, 168(DI)
 	MOVQ CX, 176(DI)
 	MOVQ DX, 184(DI)

	RET
